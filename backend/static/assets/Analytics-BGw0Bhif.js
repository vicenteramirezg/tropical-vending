import{a as L}from"./api-CdhKsZ7p.js";import{b as E,a as N}from"./dateUtils-CXdyRzwD.js";import{r as _,q as T,c as l,o as d,b as t,i as q,d as O,F as M,e as S,t as i,f as h,n as R,g as U,u as p,h as j}from"./index-DV-V0oJl.js";function H(){const a=_(!0),x=_(null),n=_([]),e=_({dateRange:"30",startDate:"",endDate:"",location:""}),s=_({revenue:{total:0,change:0},profit:{total:0,change:0},margin:{total:0,change:0}}),r=_({low_stock_count:0,items:[]}),m=_({unit_counts:[],products:[]}),g=T(()=>m.value.unit_counts?[...m.value.unit_counts].sort((o,c)=>o.location_name!==c.location_name?o.location_name.localeCompare(c.location_name):o.machine_name!==c.machine_name?o.machine_name.localeCompare(c.machine_name):o.product_name!==c.product_name?o.product_name.localeCompare(c.product_name):new Date(c.end_date)-new Date(o.end_date)):[]),u=o=>o<=0?"bg-red-100 text-red-800":o<=3?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800",f=o=>o==null?"bg-gray-100 text-gray-800":o>10?"bg-green-100 text-green-800":o<-10?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800",b=o=>o==null?"+0.0%":`${o>=0?"+":""}${o.toFixed(1)}%`,D=o=>o==null?"0.0/day":o.toFixed(1)+"/day",$=async()=>{try{const o=await L.getLocations();n.value=o.data}catch(o){console.error("Error fetching locations:",o)}},C=async()=>{var o,c,y,P,V,z;try{const B={days:e.value.dateRange!=="custom"?e.value.dateRange:void 0,start_date:e.value.dateRange==="custom"?e.value.startDate:void 0,end_date:e.value.dateRange==="custom"?e.value.endDate:void 0,location:e.value.location||void 0},k=await L.getRevenueProfitData(B);if(!k.data){s.value={revenue:{total:0,change:0},profit:{total:0,change:0},margin:{total:0,change:0}};return}s.value={revenue:{total:((o=k.data.revenue)==null?void 0:o.total)||0,change:((c=k.data.revenue)==null?void 0:c.change)||0},profit:{total:((y=k.data.profit)==null?void 0:y.total)||0,change:((P=k.data.profit)==null?void 0:P.change)||0},margin:{total:((V=k.data.margin)==null?void 0:V.total)||0,change:((z=k.data.margin)==null?void 0:z.change)||0}}}catch(B){console.error("Error fetching revenue/profit data:",B),x.value="Failed to load revenue and profit data",s.value={revenue:{total:0,change:0},profit:{total:0,change:0},margin:{total:0,change:0}}}},F=async()=>{try{const o={location:e.value.location||void 0},c=await L.getStockLevels(o);if(!c.data){r.value={low_stock_count:0,items:[]};return}r.value={low_stock_count:c.data.low_stock_count||0,items:c.data.items||[]}}catch(o){console.error("Error fetching stock level data:",o),x.value="Failed to load stock level data",r.value={low_stock_count:0,items:[]}}},w=async()=>{try{const o={days:e.value.dateRange!=="custom"?e.value.dateRange:void 0,start_date:e.value.dateRange==="custom"?e.value.startDate:void 0,end_date:e.value.dateRange==="custom"?e.value.endDate:void 0,location:e.value.location||void 0},c=await L.getDemandAnalysis(o);if(console.log("Demand analysis data:",c.data),!c.data){m.value={products:[],unit_counts:[]};return}Array.isArray(c.data)?m.value={products:c.data||[],unit_counts:[]}:(m.value={products:c.data.products||[],unit_counts:c.data.unit_counts||[]},m.value.unit_counts&&m.value.unit_counts.length>0&&m.value.unit_counts.forEach(y=>{y.start_date&&(y.start_date=new Date(y.start_date)),y.end_date&&(y.end_date=new Date(y.end_date))}))}catch(o){console.error("Error fetching demand analysis data:",o),x.value="Failed to load demand analysis data",m.value={products:[],unit_counts:[]}}},v=async()=>{a.value=!0,x.value=null;try{if(e.value.dateRange==="custom"&&(!e.value.startDate||!e.value.endDate)){const o=N(),c=new Date;c.setDate(c.getDate()-30);const y=c.toLocaleDateString("en-CA",{timeZone:"America/New_York"});e.value.endDate||(e.value.endDate=o),e.value.startDate||(e.value.startDate=y)}await Promise.all([C(),F(),w()])}catch(o){console.error("Error refreshing data:",o),x.value="Failed to refresh analytics data"}finally{a.value=!1}};return{loading:a,error:x,locations:n,filters:e,revenueProfitData:s,stockLevelData:r,demandData:m,sortedDemandCounts:g,getStockLevelClass:u,getTrendClass:f,formatTrend:b,formatDailyDemand:D,formatDateShort:E,applyFilters:v,initialize:async()=>{try{await $(),await v()}catch(o){console.error("Error initializing analytics:",o),x.value="Failed to load analytics data"}finally{a.value=!1}}}}const I={class:"bg-white p-5 shadow-lg rounded-xl mb-6"},Y={class:"flex flex-wrap items-center gap-4"},Z=["value"],G={key:0,class:"flex space-x-2"},J=["value"],K=["value"],Q=["value"],W=["value"],X={class:"self-end ml-auto mt-4"},tt={__name:"FilterControls",props:{filters:{type:Object,required:!0},locations:{type:Array,required:!0}},emits:["apply-filters","update-filters"],setup(a,{emit:x}){const n=x,e=g=>{n("update-filters",{dateRange:g.target.value})},s=g=>{n("update-filters",{startDate:g.target.value})},r=g=>{n("update-filters",{endDate:g.target.value})},m=g=>{n("update-filters",{location:g.target.value})};return(g,u)=>(d(),l("div",I,[t("div",Y,[t("div",null,[u[2]||(u[2]=t("label",{for:"dateRange",class:"block text-sm font-medium text-gray-700 mb-1"},"Date Range",-1)),t("select",{id:"dateRange",value:a.filters.dateRange,onChange:e,class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},u[1]||(u[1]=[O('<option value="7">Last 7 days</option><option value="30">Last 30 days</option><option value="90">Last 90 days</option><option value="365">Last 12 months</option><option value="custom">Custom range</option>',5)]),40,Z)]),a.filters.dateRange==="custom"?(d(),l("div",G,[t("div",null,[u[3]||(u[3]=t("label",{for:"startDate",class:"block text-sm font-medium text-gray-700 mb-1"},"Start Date",-1)),t("input",{type:"date",id:"startDate",value:a.filters.startDate,onInput:s,class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},null,40,J)]),t("div",null,[u[4]||(u[4]=t("label",{for:"endDate",class:"block text-sm font-medium text-gray-700 mb-1"},"End Date",-1)),t("input",{type:"date",id:"endDate",value:a.filters.endDate,onInput:r,class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},null,40,K)])])):q("",!0),t("div",null,[u[6]||(u[6]=t("label",{for:"location",class:"block text-sm font-medium text-gray-700 mb-1"},"Location",-1)),t("select",{id:"location",value:a.filters.location,onChange:m,class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},[u[5]||(u[5]=t("option",{value:""},"All Locations",-1)),(d(!0),l(M,null,S(a.locations,f=>(d(),l("option",{key:f.id,value:f.id},i(f.name),9,W))),128))],40,Q)]),t("div",X,[t("button",{type:"button",onClick:u[0]||(u[0]=f=>g.$emit("apply-filters")),class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-150"},u[7]||(u[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1),h(" Apply Filters ")]))])])]))}},et={class:"bg-white shadow-lg overflow-hidden sm:rounded-xl mb-6 transition-all duration-300 hover:shadow-xl"},at={class:"grid grid-cols-1 md:grid-cols-3 divide-y md:divide-y-0 md:divide-x divide-gray-200"},st={class:"px-6 py-5"},ot={class:"mt-2 text-3xl font-bold text-gray-900"},nt={class:"mt-2 text-sm text-gray-500 flex items-center"},rt={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},lt={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},dt={class:"px-6 py-5"},it={class:"mt-2 text-3xl font-bold text-green-600"},ct={class:"mt-2 text-sm text-gray-500 flex items-center"},ut={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},mt={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},xt={class:"px-6 py-5"},gt={class:"mt-2 text-3xl font-bold text-gray-900"},pt={class:"mt-2 text-sm text-gray-500 flex items-center"},vt={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ft={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},yt={__name:"RevenueProfit",props:{data:{type:Object,required:!0,default:()=>({revenue:{total:0,change:0},profit:{total:0,change:0},margin:{total:0,change:0}})}},setup(a){return(x,n)=>{var e,s,r,m,g,u,f,b,D,$,C,F,w,v,A;return d(),l("div",et,[n[12]||(n[12]=t("div",{class:"px-6 py-5 border-b border-gray-100"},[t("h3",{class:"text-lg leading-6 font-medium text-gray-900"},"Revenue & Profit"),t("p",{class:"mt-1 text-sm text-gray-500"}," Financial performance for the selected period ")],-1)),t("div",null,[t("div",at,[t("div",st,[n[3]||(n[3]=t("div",{class:"text-sm font-medium text-gray-500"},"Total Revenue",-1)),t("div",ot,"$"+i((((e=a.data.revenue)==null?void 0:e.total)||0).toFixed(2)),1),t("div",nt,[t("span",{class:R([(((s=a.data.revenue)==null?void 0:s.change)||0)>=0?"text-green-600":"text-red-600","flex items-center"])},[(((r=a.data.revenue)==null?void 0:r.change)||0)>=0?(d(),l("svg",rt,n[0]||(n[0]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"},null,-1)]))):(d(),l("svg",lt,n[1]||(n[1]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"},null,-1)]))),h(" "+i((((m=a.data.revenue)==null?void 0:m.change)||0)>=0?"+":"")+i((((g=a.data.revenue)==null?void 0:g.change)||0).toFixed(1))+"% ",1)],2),n[2]||(n[2]=t("span",{class:"ml-1"},"vs previous period",-1))])]),t("div",dt,[n[7]||(n[7]=t("div",{class:"text-sm font-medium text-gray-500"},"Total Profit",-1)),t("div",it,"$"+i((((u=a.data.profit)==null?void 0:u.total)||0).toFixed(2)),1),t("div",ct,[t("span",{class:R([(((f=a.data.profit)==null?void 0:f.change)||0)>=0?"text-green-600":"text-red-600","flex items-center"])},[(((b=a.data.profit)==null?void 0:b.change)||0)>=0?(d(),l("svg",ut,n[4]||(n[4]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"},null,-1)]))):(d(),l("svg",mt,n[5]||(n[5]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"},null,-1)]))),h(" "+i((((D=a.data.profit)==null?void 0:D.change)||0)>=0?"+":"")+i(((($=a.data.profit)==null?void 0:$.change)||0).toFixed(1))+"% ",1)],2),n[6]||(n[6]=t("span",{class:"ml-1"},"vs previous period",-1))])]),t("div",xt,[n[11]||(n[11]=t("div",{class:"text-sm font-medium text-gray-500"},"Profit Margin",-1)),t("div",gt,i((((C=a.data.margin)==null?void 0:C.total)||0).toFixed(1))+"%",1),t("div",pt,[t("span",{class:R([(((F=a.data.margin)==null?void 0:F.change)||0)>=0?"text-green-600":"text-red-600","flex items-center"])},[(((w=a.data.margin)==null?void 0:w.change)||0)>=0?(d(),l("svg",vt,n[8]||(n[8]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"},null,-1)]))):(d(),l("svg",ft,n[9]||(n[9]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"},null,-1)]))),h(" "+i((((v=a.data.margin)==null?void 0:v.change)||0)>=0?"+":"")+i((((A=a.data.margin)==null?void 0:A.change)||0).toFixed(1))+"% ",1)],2),n[10]||(n[10]=t("span",{class:"ml-1"},"vs previous period",-1))])])])])])}}},ht={class:"bg-white shadow-lg overflow-hidden sm:rounded-xl mb-6 transition-all duration-300 hover:shadow-xl"},wt={class:"px-6 py-5 border-b border-gray-100 flex justify-between items-center"},kt={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},_t={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},bt={role:"list",class:"divide-y divide-gray-200"},Dt={class:"flex items-center justify-between"},$t={class:"text-sm font-medium text-primary-600"},Ct={class:"text-sm text-gray-500 flex items-center mt-1"},Ft={__name:"StockLevels",props:{data:{type:Object,required:!0,default:()=>({low_stock_count:0,items:[]})}},setup(a){const x=n=>n<=0?"bg-red-100 text-red-800":n<=3?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800";return(n,e)=>(d(),l("div",ht,[t("div",wt,[e[2]||(e[2]=t("div",null,[t("h3",{class:"text-lg leading-6 font-medium text-gray-900"},"Stock Levels"),t("p",{class:"mt-1 text-sm text-gray-500"}," Current inventory levels across machines ")],-1)),t("span",{class:R(["inline-flex items-center px-3.5 py-1 rounded-full text-sm font-medium",a.data.low_stock_count>0?"bg-red-100 text-red-800":"bg-green-100 text-green-800"])},[a.data.low_stock_count>0?(d(),l("svg",kt,e[0]||(e[0]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)]))):(d(),l("svg",_t,e[1]||(e[1]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))),h(" "+i(a.data.low_stock_count)+" items low stock ",1)],2)]),t("div",null,[t("ul",bt,[(d(!0),l(M,null,S(a.data.items,(s,r)=>(d(),l("li",{key:r,class:"px-6 py-4 hover:bg-gray-50 transition-colors duration-150"},[t("div",Dt,[t("div",null,[t("p",$t,i(s.product_name),1),t("p",Ct,[e[3]||(e[3]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1)),h(" "+i(s.machine_name)+" at "+i(s.location_name),1)])]),t("div",null,[t("span",{class:R(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",x(s.current_stock)])}," Stock: "+i(s.current_stock),3)])])]))),128))])])]))}},Rt={class:"bg-white shadow-lg overflow-hidden sm:rounded-xl transition-all duration-300 hover:shadow-xl"},Lt={class:"overflow-x-auto"},jt={class:"min-w-full divide-y divide-gray-200"},Mt={class:"bg-white divide-y divide-gray-200"},St={class:"px-6 py-4 whitespace-nowrap"},At={class:"text-sm font-medium text-gray-900"},Bt={class:"px-6 py-4 whitespace-nowrap text-center"},Pt={class:"text-sm text-gray-900"},Vt={class:"px-6 py-4 whitespace-nowrap text-center"},zt={class:"text-sm text-gray-900"},Tt={class:"px-6 py-4 whitespace-nowrap text-center"},Et={class:"text-sm text-gray-900"},Nt={class:"px-6 py-4 whitespace-nowrap text-center"},qt={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ot={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ut={key:2,xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ht={key:0,class:"mt-6 px-6"},It={class:"border rounded-lg shadow-sm overflow-hidden"},Yt={class:"min-w-full divide-y divide-gray-200"},Zt={class:"bg-white divide-y divide-gray-200"},Gt={class:"px-4 py-3 text-sm text-gray-900"},Jt={class:"px-4 py-3 text-sm text-gray-900"},Kt={class:"px-4 py-3 text-sm text-gray-900"},Qt={class:"px-4 py-3 text-sm text-gray-500 text-center"},Wt={class:"text-xs text-gray-400"},Xt={class:"px-4 py-3 text-sm text-gray-900 text-center font-medium"},te={class:"px-4 py-3 text-sm text-gray-900 text-center"},ee={class:"px-4 py-3 text-sm text-gray-900 text-center"},ae={key:1,class:"px-6 py-4 text-center"},se={key:2,class:"px-6 py-4 text-center"},oe={__name:"DemandAnalysis",props:{data:{type:Object,required:!0,default:()=>({products:[],unit_counts:[]})},formatDateShort:{type:Function,required:!0},formatDailyDemand:{type:Function,required:!0},formatTrend:{type:Function,required:!0},getTrendClass:{type:Function,required:!0}},setup(a){const x=a,n=T(()=>x.data.unit_counts?[...x.data.unit_counts].sort((e,s)=>e.location_name!==s.location_name?e.location_name.localeCompare(s.location_name):e.machine_name!==s.machine_name?e.machine_name.localeCompare(s.machine_name):e.product_name!==s.product_name?e.product_name.localeCompare(s.product_name):new Date(s.end_date)-new Date(e.end_date)):[]);return(e,s)=>(d(),l("div",Rt,[s[8]||(s[8]=t("div",{class:"px-6 py-5 border-b border-gray-100"},[t("h3",{class:"text-lg leading-6 font-medium text-gray-900"},"Product Demand Analysis"),t("p",{class:"mt-1 text-sm text-gray-500"}," Sales performance and demand tracking based on restock data ")],-1)),t("div",null,[t("div",Lt,[t("table",jt,[s[3]||(s[3]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Product "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Units Sold "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Revenue "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Profit "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Trend ")])],-1)),t("tbody",Mt,[(d(!0),l(M,null,S(a.data.products,r=>(d(),l("tr",{key:r.product_id,class:"hover:bg-gray-50 transition-colors duration-150"},[t("td",St,[t("div",At,i(r.product_name),1)]),t("td",Bt,[t("div",Pt,i(r.units_sold),1)]),t("td",Vt,[t("div",zt,"$"+i((r.revenue||0).toFixed(2)),1)]),t("td",Tt,[t("div",Et,"$"+i((r.profit||0).toFixed(2)),1)]),t("td",Nt,[t("span",{class:R(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",a.getTrendClass(r.trend||0)])},[(r.trend||0)>0?(d(),l("svg",qt,s[0]||(s[0]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"},null,-1)]))):(r.trend||0)<0?(d(),l("svg",Ot,s[1]||(s[1]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"},null,-1)]))):(d(),l("svg",Ut,s[2]||(s[2]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 12H6"},null,-1)]))),h(" "+i(a.formatTrend(r.trend||0)),1)],2)])]))),128))])])]),a.data.unit_counts&&a.data.unit_counts.length>0?(d(),l("div",Ht,[s[5]||(s[5]=t("h4",{class:"text-base font-medium text-gray-700 mb-3"},"Detailed Demand By Machine & Product",-1)),t("div",It,[t("table",Yt,[s[4]||(s[4]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"}," Location "),t("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"}," Machine "),t("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"}," Product "),t("th",{scope:"col",class:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase"}," Period "),t("th",{scope:"col",class:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase"}," Units Sold "),t("th",{scope:"col",class:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase"}," Daily Demand "),t("th",{scope:"col",class:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase"}," Revenue ")])],-1)),t("tbody",Zt,[(d(!0),l(M,null,S(n.value,(r,m)=>(d(),l("tr",{key:m,class:"hover:bg-gray-50"},[t("td",Gt,i(r.location_name),1),t("td",Jt,i(r.machine_name),1),t("td",Kt,i(r.product_name),1),t("td",Qt,[h(i(a.formatDateShort(r.start_date))+" - "+i(a.formatDateShort(r.end_date))+" ",1),t("div",Wt,"("+i(r.days_between)+" days)",1)]),t("td",Xt,i(r.units_sold),1),t("td",te,i(a.formatDailyDemand(r.daily_demand)),1),t("td",ee," $"+i((r.revenue||0).toFixed(2)),1)]))),128))])])])])):a.data.products&&a.data.products.length>0&&(!a.data.unit_counts||a.data.unit_counts.length===0)?(d(),l("div",ae,s[6]||(s[6]=[t("p",{class:"text-sm text-gray-500"},[h(" No detailed demand data is available for the selected period. "),t("br"),h("Need at least two restock visits to the same machine to calculate demand. ")],-1)]))):(d(),l("div",se,s[7]||(s[7]=[t("p",{class:"text-sm text-gray-500"}," No demand data available. Record restock visits to track product demand. ",-1)])))])]))}},ne={key:0,class:"flex justify-center py-20"},re={key:1,class:"bg-red-50 border-l-4 border-red-400 p-4 mb-6 rounded-r-lg shadow-sm"},le={class:"flex"},de={class:"ml-3"},ie={class:"text-sm text-red-700"},ce={key:2},ge={__name:"Analytics",setup(a){const{loading:x,error:n,locations:e,filters:s,revenueProfitData:r,stockLevelData:m,demandData:g,formatDateShort:u,formatDailyDemand:f,formatTrend:b,getTrendClass:D,applyFilters:$,initialize:C}=H(),F=w=>{Object.assign(s.value,w)};return U(()=>{C()}),(w,v)=>(d(),l("div",null,[v[2]||(v[2]=t("h1",{class:"text-2xl font-semibold text-gray-900 mb-6"},"Analytics",-1)),p(x)?(d(),l("div",ne,v[0]||(v[0]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"},null,-1)]))):p(n)?(d(),l("div",re,[t("div",le,[v[1]||(v[1]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),t("div",de,[t("p",ie,i(p(n)),1)])])])):(d(),l("div",ce,[j(tt,{filters:p(s),locations:p(e),onApplyFilters:p($),onUpdateFilters:F},null,8,["filters","locations","onApplyFilters"]),j(yt,{data:p(r)},null,8,["data"]),j(Ft,{data:p(m)},null,8,["data"]),j(oe,{data:p(g),"format-date-short":p(u),"format-daily-demand":p(f),"format-trend":p(b),"get-trend-class":p(D)},null,8,["data","format-date-short","format-daily-demand","format-trend","get-trend-class"])]))]))}};export{ge as default};
