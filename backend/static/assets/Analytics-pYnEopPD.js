import{r as u,o as V,c as n,a as t,t as l,g as S,w as x,v as b,b as P,i as _,F as f,d as y,e as c,n as m,f as a}from"./index-Bm6kIZ6r.js";import{a as w}from"./api-DFa5bdwe.js";const z={key:0,class:"flex justify-center py-20"},A={key:1,class:"bg-red-50 border-l-4 border-red-400 p-4 mb-6 rounded-r-lg shadow-sm"},T={class:"flex"},E={class:"ml-3"},$={class:"text-sm text-red-700"},U={key:2},N={class:"bg-white p-5 shadow-lg rounded-xl mb-6"},H={class:"flex flex-wrap items-center gap-4"},I={key:0,class:"flex space-x-2"},O=["value"],G={class:"bg-white shadow-lg overflow-hidden sm:rounded-xl mb-6 transition-all duration-300 hover:shadow-xl"},J={class:"grid grid-cols-1 md:grid-cols-3 divide-y md:divide-y-0 md:divide-x divide-gray-200"},K={class:"px-6 py-5"},Q={class:"mt-2 text-3xl font-bold text-gray-900"},W={class:"mt-2 text-sm text-gray-500 flex items-center"},X={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Y={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Z={class:"px-6 py-5"},q={class:"mt-2 text-3xl font-bold text-green-600"},tt={class:"mt-2 text-sm text-gray-500 flex items-center"},et={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},st={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ot={class:"px-6 py-5"},rt={class:"mt-2 text-3xl font-bold text-gray-900"},nt={class:"mt-2 text-sm text-gray-500 flex items-center"},at={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},lt={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},it={class:"bg-white shadow-lg overflow-hidden sm:rounded-xl mb-6 transition-all duration-300 hover:shadow-xl"},dt={class:"px-6 py-5 border-b border-gray-100 flex justify-between items-center"},ut={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ct={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},mt={role:"list",class:"divide-y divide-gray-200"},vt={class:"flex items-center justify-between"},pt={class:"text-sm font-medium text-primary-600"},gt={class:"text-sm text-gray-500 flex items-center mt-1"},xt={class:"bg-white shadow-lg overflow-hidden sm:rounded-xl transition-all duration-300 hover:shadow-xl"},wt={class:"overflow-x-auto"},ft={class:"min-w-full divide-y divide-gray-200"},yt={class:"bg-white divide-y divide-gray-200"},ht={class:"px-6 py-4 whitespace-nowrap"},kt={class:"text-sm font-medium text-gray-900"},bt={class:"px-6 py-4 whitespace-nowrap text-center"},_t={class:"text-sm text-gray-900"},Dt={class:"px-6 py-4 whitespace-nowrap text-center"},Ct={class:"text-sm text-gray-900"},Rt={class:"px-6 py-4 whitespace-nowrap text-center"},Mt={class:"text-sm text-gray-900"},Ft={class:"px-6 py-4 whitespace-nowrap text-center"},Bt={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Lt={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},jt={key:2,xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},zt={__name:"Analytics",setup(Vt){const p=u(!0),d=u(null),h=u([]),o=u({dateRange:"30",startDate:"",endDate:"",location:""}),i=u({revenue:{total:0,change:0},profit:{total:0,change:0},margin:{total:0,change:0}}),v=u({low_stock_count:0,items:[]}),k=u({products:[]}),D=s=>s<=0?"bg-red-100 text-red-800":s<=3?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800",C=s=>s>10?"bg-green-100 text-green-800":s<-10?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800",R=s=>`${s>=0?"+":""}${s.toFixed(1)}%`,M=async()=>{try{const s=await w.getLocations();h.value=s.data}catch(s){console.error("Error fetching locations:",s)}},F=async()=>{try{const s={days:o.value.dateRange!=="custom"?o.value.dateRange:void 0,start_date:o.value.dateRange==="custom"?o.value.startDate:void 0,end_date:o.value.dateRange==="custom"?o.value.endDate:void 0,location:o.value.location||void 0},e=await w.getRevenueProfitData(s);i.value=e.data}catch(s){console.error("Error fetching revenue/profit data:",s),d.value="Failed to load revenue and profit data"}},B=async()=>{try{const s={location:o.value.location||void 0},e=await w.getStockLevels(s);v.value=e.data}catch(s){console.error("Error fetching stock level data:",s),d.value="Failed to load stock level data"}},L=async()=>{try{const s={days:o.value.dateRange!=="custom"?o.value.dateRange:void 0,start_date:o.value.dateRange==="custom"?o.value.startDate:void 0,end_date:o.value.dateRange==="custom"?o.value.endDate:void 0,location:o.value.location||void 0},e=await w.getDemandAnalysis(s);k.value=e.data}catch(s){console.error("Error fetching demand analysis data:",s),d.value="Failed to load demand analysis data"}},g=async()=>{p.value=!0,d.value=null;try{if(o.value.dateRange==="custom"&&(!o.value.startDate||!o.value.endDate)){const s=new Date,e=new Date(s);e.setDate(s.getDate()-30),o.value.endDate||(o.value.endDate=s.toISOString().split("T")[0]),o.value.startDate||(o.value.startDate=e.toISOString().split("T")[0])}await Promise.all([F(),B(),L()])}catch(s){console.error("Error refreshing data:",s),d.value="Failed to refresh analytics data"}finally{p.value=!1}};return V(async()=>{try{await M(),await g()}catch(s){console.error("Error initializing analytics:",s),d.value="Failed to load analytics data"}finally{p.value=!1}}),(s,e)=>(a(),n("div",null,[e[35]||(e[35]=t("h1",{class:"text-2xl font-semibold text-gray-900 mb-6"},"Analytics",-1)),p.value?(a(),n("div",z,e[4]||(e[4]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"},null,-1)]))):d.value?(a(),n("div",A,[t("div",T,[e[5]||(e[5]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),t("div",E,[t("p",$,l(d.value),1)])])])):(a(),n("div",U,[t("div",N,[t("div",H,[t("div",null,[e[7]||(e[7]=t("label",{for:"dateRange",class:"block text-sm font-medium text-gray-700 mb-1"},"Date Range",-1)),x(t("select",{id:"dateRange","onUpdate:modelValue":e[0]||(e[0]=r=>o.value.dateRange=r),class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",onChange:g},e[6]||(e[6]=[P('<option value="7">Last 7 days</option><option value="30">Last 30 days</option><option value="90">Last 90 days</option><option value="365">Last 12 months</option><option value="custom">Custom range</option>',5)]),544),[[b,o.value.dateRange]])]),o.value.dateRange==="custom"?(a(),n("div",I,[t("div",null,[e[8]||(e[8]=t("label",{for:"startDate",class:"block text-sm font-medium text-gray-700 mb-1"},"Start Date",-1)),x(t("input",{type:"date",id:"startDate","onUpdate:modelValue":e[1]||(e[1]=r=>o.value.startDate=r),class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},null,512),[[_,o.value.startDate]])]),t("div",null,[e[9]||(e[9]=t("label",{for:"endDate",class:"block text-sm font-medium text-gray-700 mb-1"},"End Date",-1)),x(t("input",{type:"date",id:"endDate","onUpdate:modelValue":e[2]||(e[2]=r=>o.value.endDate=r),class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"},null,512),[[_,o.value.endDate]])])])):S("",!0),t("div",null,[e[11]||(e[11]=t("label",{for:"location",class:"block text-sm font-medium text-gray-700 mb-1"},"Location",-1)),x(t("select",{id:"location","onUpdate:modelValue":e[3]||(e[3]=r=>o.value.location=r),class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",onChange:g},[e[10]||(e[10]=t("option",{value:""},"All Locations",-1)),(a(!0),n(f,null,y(h.value,r=>(a(),n("option",{key:r.id,value:r.id},l(r.name),9,O))),128))],544),[[b,o.value.location]])]),t("div",{class:"self-end ml-auto mt-4"},[t("button",{type:"button",onClick:g,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-150"},e[12]||(e[12]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1),c(" Apply Filters ")]))])])]),t("div",G,[e[25]||(e[25]=t("div",{class:"px-6 py-5 border-b border-gray-100"},[t("h3",{class:"text-lg leading-6 font-medium text-gray-900"},"Revenue & Profit"),t("p",{class:"mt-1 text-sm text-gray-500"}," Financial performance for the selected period ")],-1)),t("div",null,[t("div",J,[t("div",K,[e[16]||(e[16]=t("div",{class:"text-sm font-medium text-gray-500"},"Total Revenue",-1)),t("div",Q,"$"+l(i.value.revenue.total.toFixed(2)),1),t("div",W,[t("span",{class:m([i.value.revenue.change>=0?"text-green-600":"text-red-600","flex items-center"])},[i.value.revenue.change>=0?(a(),n("svg",X,e[13]||(e[13]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"},null,-1)]))):(a(),n("svg",Y,e[14]||(e[14]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"},null,-1)]))),c(" "+l(i.value.revenue.change>=0?"+":"")+l(i.value.revenue.change.toFixed(1))+"% ",1)],2),e[15]||(e[15]=t("span",{class:"ml-1"},"vs previous period",-1))])]),t("div",Z,[e[20]||(e[20]=t("div",{class:"text-sm font-medium text-gray-500"},"Total Profit",-1)),t("div",q,"$"+l(i.value.profit.total.toFixed(2)),1),t("div",tt,[t("span",{class:m([i.value.profit.change>=0?"text-green-600":"text-red-600","flex items-center"])},[i.value.profit.change>=0?(a(),n("svg",et,e[17]||(e[17]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"},null,-1)]))):(a(),n("svg",st,e[18]||(e[18]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"},null,-1)]))),c(" "+l(i.value.profit.change>=0?"+":"")+l(i.value.profit.change.toFixed(1))+"% ",1)],2),e[19]||(e[19]=t("span",{class:"ml-1"},"vs previous period",-1))])]),t("div",ot,[e[24]||(e[24]=t("div",{class:"text-sm font-medium text-gray-500"},"Profit Margin",-1)),t("div",rt,l(i.value.margin.total.toFixed(1))+"%",1),t("div",nt,[t("span",{class:m([i.value.margin.change>=0?"text-green-600":"text-red-600","flex items-center"])},[i.value.margin.change>=0?(a(),n("svg",at,e[21]||(e[21]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"},null,-1)]))):(a(),n("svg",lt,e[22]||(e[22]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"},null,-1)]))),c(" "+l(i.value.margin.change>=0?"+":"")+l(i.value.margin.change.toFixed(1))+"% ",1)],2),e[23]||(e[23]=t("span",{class:"ml-1"},"vs previous period",-1))])])])])]),t("div",it,[t("div",dt,[e[28]||(e[28]=t("div",null,[t("h3",{class:"text-lg leading-6 font-medium text-gray-900"},"Stock Levels"),t("p",{class:"mt-1 text-sm text-gray-500"}," Current inventory levels across machines ")],-1)),t("span",{class:m(["inline-flex items-center px-3.5 py-1 rounded-full text-sm font-medium",v.value.low_stock_count>0?"bg-red-100 text-red-800":"bg-green-100 text-green-800"])},[v.value.low_stock_count>0?(a(),n("svg",ut,e[26]||(e[26]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)]))):(a(),n("svg",ct,e[27]||(e[27]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))),c(" "+l(v.value.low_stock_count)+" items low stock ",1)],2)]),t("div",null,[t("ul",mt,[(a(!0),n(f,null,y(v.value.items,(r,j)=>(a(),n("li",{key:j,class:"px-6 py-4 hover:bg-gray-50 transition-colors duration-150"},[t("div",vt,[t("div",null,[t("p",pt,l(r.product_name),1),t("p",gt,[e[29]||(e[29]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1)),c(" "+l(r.machine_name)+" at "+l(r.location_name),1)])]),t("div",null,[t("span",{class:m(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",D(r.current_stock)])}," Stock: "+l(r.current_stock),3)])])]))),128))])])]),t("div",xt,[e[34]||(e[34]=t("div",{class:"px-6 py-5 border-b border-gray-100"},[t("h3",{class:"text-lg leading-6 font-medium text-gray-900"},"Product Demand Analysis"),t("p",{class:"mt-1 text-sm text-gray-500"}," Sales performance by product ")],-1)),t("div",null,[t("div",wt,[t("table",ft,[e[33]||(e[33]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Product "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Units Sold "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Revenue "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Profit "),t("th",{scope:"col",class:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider"}," Trend ")])],-1)),t("tbody",yt,[(a(!0),n(f,null,y(k.value.products,r=>(a(),n("tr",{key:r.product_id,class:"hover:bg-gray-50 transition-colors duration-150"},[t("td",ht,[t("div",kt,l(r.product_name),1)]),t("td",bt,[t("div",_t,l(r.units_sold),1)]),t("td",Dt,[t("div",Ct,"$"+l(r.revenue.toFixed(2)),1)]),t("td",Rt,[t("div",Mt,"$"+l(r.profit.toFixed(2)),1)]),t("td",Ft,[t("span",{class:m(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",C(r.trend)])},[r.trend>0?(a(),n("svg",Bt,e[30]||(e[30]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"},null,-1)]))):r.trend<0?(a(),n("svg",Lt,e[31]||(e[31]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"},null,-1)]))):(a(),n("svg",jt,e[32]||(e[32]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18 12H6"},null,-1)]))),c(" "+l(R(r.trend)),1)],2)])]))),128))])])])])])]))]))}};export{zt as default};
