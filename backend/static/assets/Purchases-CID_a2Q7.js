import{r as n,j as U,o as V,c as l,a as e,g as k,t as i,F as P,d as C,h as E,w as u,v as A,i as f,b as N,f as a}from"./index-Bm6kIZ6r.js";import{a as y}from"./api-DFa5bdwe.js";const T={key:0,class:"flex justify-center"},B={key:1,class:"bg-red-50 border-l-4 border-red-400 p-4 mb-4"},L={class:"flex"},z={class:"ml-3"},G={class:"text-sm text-red-700"},Q={key:2,class:"bg-white shadow overflow-hidden sm:rounded-lg"},W={key:3,class:"bg-white shadow overflow-hidden sm:rounded-lg"},Y={role:"list",class:"divide-y divide-gray-200"},H={class:"flex items-center justify-between"},I={class:"flex items-center"},J={class:"text-sm font-medium text-primary-600"},K={class:"ml-2 px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800"},O={class:"mt-1"},R={class:"text-sm text-gray-500"},X={class:"text-sm text-gray-500"},Z={class:"flex space-x-2"},ee=["onClick"],te=["onClick"],se={key:4,class:"fixed inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},oe={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},re={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},le={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},ie={class:"sm:flex sm:items-start"},ae={class:"mt-3 text-center sm:mt-0 sm:text-left w-full"},ne={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"},de={class:"mt-4 space-y-4"},ue=["value"],me={class:"grid grid-cols-2 gap-4"},ce={class:"bg-gray-50 p-3 rounded-md"},pe={class:"text-lg font-bold text-primary-600"},fe={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},ye={type:"submit",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:ml-3 sm:w-auto sm:text-sm"},ge={key:5,class:"fixed inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},xe={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},ve={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},be={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},ke={__name:"Purchases",setup(he){const g=n([]),w=n([]),x=n(!0),m=n(null),d=n(!1),c=n(!1),p=n(!1),v=n(null),r=n({id:null,product:"",supplier:"",purchase_date:"",quantity:1,cost_per_unit:0,notes:""}),q=U(()=>{const o=parseFloat(r.value.quantity)||0,t=parseFloat(r.value.cost_per_unit)||0;return o*t}),D=o=>o?new Date(o).toLocaleDateString():"",b=async()=>{x.value=!0;try{const o=await y.getPurchases();g.value=o.data}catch(o){console.error("Error fetching purchases:",o),m.value="Failed to load purchases. Please try again later."}finally{x.value=!1}},$=async()=>{try{const o=await y.getProducts();w.value=o.data}catch(o){console.error("Error fetching products:",o)}},_=()=>{p.value=!1;const o=new Date,t=o.getFullYear(),s=String(o.getMonth()+1).padStart(2,"0"),h=String(o.getDate()).padStart(2,"0");r.value={id:null,product:"",supplier:"",purchase_date:`${t}-${s}-${h}`,quantity:1,cost_per_unit:0,notes:""},d.value=!0},j=o=>{p.value=!0,r.value={id:o.id,product:o.product,supplier:o.supplier,purchase_date:o.purchase_date.split("T")[0],quantity:o.quantity,cost_per_unit:o.cost_per_unit,notes:o.notes||""},d.value=!0},F=async()=>{try{p.value?await y.updatePurchase(r.value.id,r.value):await y.createPurchase(r.value),d.value=!1,await b()}catch(o){console.error("Error saving purchase:",o),m.value="Failed to save purchase. Please try again."}},S=o=>{v.value=o,c.value=!0},M=async()=>{if(v.value)try{await y.deletePurchase(v.value.id),c.value=!1,await b()}catch(o){console.error("Error deleting purchase:",o),m.value="Failed to delete purchase. Please try again."}};return V(async()=>{await Promise.all([b(),$()])}),(o,t)=>(a(),l("div",null,[e("div",{class:"flex justify-between items-center mb-6"},[t[10]||(t[10]=e("h1",{class:"text-2xl font-semibold text-gray-900"},"Wholesale Purchases",-1)),e("button",{onClick:_,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"}," Add Purchase ")]),x.value?(a(),l("div",T,t[11]||(t[11]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"},null,-1)]))):m.value?(a(),l("div",B,[e("div",L,[t[12]||(t[12]=e("div",{class:"flex-shrink-0"},[e("span",{class:"text-red-400"},"⚠")],-1)),e("div",z,[e("p",G,i(m.value),1)])])])):g.value.length===0?(a(),l("div",Q,[e("div",{class:"px-4 py-5 sm:p-6 text-center"},[t[13]||(t[13]=e("h3",{class:"text-lg leading-6 font-medium text-gray-900"},"No purchases found",-1)),t[14]||(t[14]=e("div",{class:"mt-2 max-w-xl text-sm text-gray-500"},[e("p",null,"Get started by recording your first wholesale purchase.")],-1)),e("div",{class:"mt-5"},[e("button",{onClick:_,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"}," Add Purchase ")])])])):(a(),l("div",W,[e("ul",Y,[(a(!0),l(P,null,C(g.value,s=>(a(),l("li",{key:s.id,class:"px-4 py-4 sm:px-6"},[e("div",H,[e("div",null,[e("div",I,[e("p",J,i(s.product_name),1),e("span",K,i(s.quantity)+" units ",1)]),e("div",O,[e("p",R," Date: "+i(D(s.purchase_date))+" | Supplier: "+i(s.supplier),1),e("p",X," Cost: $"+i(s.cost_per_unit.toFixed(2))+" per unit | Total: $"+i((s.cost_per_unit*s.quantity).toFixed(2)),1)])]),e("div",Z,[e("button",{onClick:h=>j(s),class:"inline-flex items-center px-2.5 py-1.5 border border-gray-300 shadow-sm text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"}," Edit ",8,ee),e("button",{onClick:h=>S(s),class:"inline-flex items-center px-2.5 py-1.5 border border-gray-300 shadow-sm text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"}," Delete ",8,te)])])]))),128))])])),d.value?(a(),l("div",se,[e("div",oe,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:t[0]||(t[0]=s=>d.value=!1)}),t[23]||(t[23]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",re,[e("form",{onSubmit:E(F,["prevent"])},[e("div",le,[e("div",ie,[e("div",ae,[e("h3",ne,i(p.value?"Edit Purchase":"Add New Purchase"),1),e("div",de,[e("div",null,[t[16]||(t[16]=e("label",{for:"product",class:"block text-sm font-medium text-gray-700"},"Product",-1)),u(e("select",{id:"product",name:"product","onUpdate:modelValue":t[1]||(t[1]=s=>r.value.product=s),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md",required:""},[t[15]||(t[15]=e("option",{value:"",disabled:""},"Select a product",-1)),(a(!0),l(P,null,C(w.value,s=>(a(),l("option",{key:s.id,value:s.id},i(s.name),9,ue))),128))],512),[[A,r.value.product]])]),e("div",null,[t[17]||(t[17]=e("label",{for:"supplier",class:"block text-sm font-medium text-gray-700"},"Supplier",-1)),u(e("input",{type:"text",name:"supplier",id:"supplier","onUpdate:modelValue":t[2]||(t[2]=s=>r.value.supplier=s),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",required:""},null,512),[[f,r.value.supplier]])]),e("div",null,[t[18]||(t[18]=e("label",{for:"purchase_date",class:"block text-sm font-medium text-gray-700"},"Purchase Date",-1)),u(e("input",{type:"date",name:"purchase_date",id:"purchase_date","onUpdate:modelValue":t[3]||(t[3]=s=>r.value.purchase_date=s),class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",required:""},null,512),[[f,r.value.purchase_date]])]),e("div",me,[e("div",null,[t[19]||(t[19]=e("label",{for:"quantity",class:"block text-sm font-medium text-gray-700"},"Quantity",-1)),u(e("input",{type:"number",name:"quantity",id:"quantity","onUpdate:modelValue":t[4]||(t[4]=s=>r.value.quantity=s),min:"1",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",required:""},null,512),[[f,r.value.quantity]])]),e("div",null,[t[20]||(t[20]=e("label",{for:"cost_per_unit",class:"block text-sm font-medium text-gray-700"},"Cost Per Unit ($)",-1)),u(e("input",{type:"number",name:"cost_per_unit",id:"cost_per_unit","onUpdate:modelValue":t[5]||(t[5]=s=>r.value.cost_per_unit=s),min:"0.01",step:"0.01",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",required:""},null,512),[[f,r.value.cost_per_unit]])])]),e("div",null,[t[21]||(t[21]=e("label",{for:"notes",class:"block text-sm font-medium text-gray-700"},"Notes",-1)),u(e("textarea",{id:"notes",name:"notes",rows:"3","onUpdate:modelValue":t[6]||(t[6]=s=>r.value.notes=s),class:"shadow-sm focus:ring-primary-500 focus:border-primary-500 mt-1 block w-full sm:text-sm border border-gray-300 rounded-md"},null,512),[[f,r.value.notes]])]),e("div",ce,[t[22]||(t[22]=e("div",{class:"text-sm font-medium text-gray-700"},"Total Cost:",-1)),e("div",pe," $"+i(q.value.toFixed(2)),1)])])])])]),e("div",fe,[e("button",ye,i(p.value?"Update":"Add"),1),e("button",{type:"button",onClick:t[7]||(t[7]=s=>d.value=!1),class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Cancel ")])],32)])])])):k("",!0),c.value?(a(),l("div",ge,[e("div",xe,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:t[8]||(t[8]=s=>c.value=!1)}),t[25]||(t[25]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",ve,[t[24]||(t[24]=N('<div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"><div class="sm:flex sm:items-start"><div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10"><svg class="h-6 w-6 text-red-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div><div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"><h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title"> Delete Purchase </h3><div class="mt-2"><p class="text-sm text-gray-500"> Are you sure you want to delete this purchase record? This action cannot be undone. </p></div></div></div></div>',1)),e("div",be,[e("button",{type:"button",onClick:M,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm"}," Delete "),e("button",{type:"button",onClick:t[9]||(t[9]=s=>c.value=!1),class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Cancel ")])])])])):k("",!0)]))}};export{ke as default};
