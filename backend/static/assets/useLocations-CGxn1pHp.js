import{a as l}from"./api-Du8a7PfL.js";import{r as s,c as g,k as P}from"./index-D8I-E458.js";function T(){const o=s([]),r=s([]),v=s([]),f=s(!0),c=s(null),a=s(""),p=s([]),u=s(""),h={Vending:"bg-blue-100 text-blue-800",Coffee:"bg-amber-100 text-amber-800",Snack:"bg-green-100 text-green-800",Drink:"bg-purple-100 text-purple-800"},w=g(()=>{const e={};return o.value.forEach(t=>{e[t.id]={}}),v.value.forEach(t=>{t.location&&(e[t.location]||(e[t.location]={}),e[t.location][t.machine_type]||(e[t.location][t.machine_type]=0),e[t.location][t.machine_type]++)}),e}),m=g(()=>{let e=r.value;if(a.value&&(a.value==="unassigned"?e=e.filter(t=>!t.route):e=e.filter(t=>t.route===a.value)),u.value.trim()){const t=u.value.toLowerCase().trim();e=e.filter(n=>n.name.toLowerCase().includes(t)||n.address.toLowerCase().includes(t))}return e}),L=g(()=>p.value),i=async()=>{f.value=!0;try{const e=await l.getLocations(),t=e.data.results||e.data;r.value=t,o.value=t,await Promise.all([b(),y()])}catch(e){console.error("Error fetching locations:",e),c.value="Failed to load locations. Please try again later."}finally{f.value=!1}},b=async()=>{try{const e=await l.getMachines();v.value=e.data.results||e.data}catch(e){console.error("Error fetching machines:",e)}},y=async()=>{try{const e=await l.getRoutes();p.value=e.data.routes}catch(e){console.error("Error fetching routes:",e)}},E=async e=>{try{await l.createLocation(e),await i(),d()}catch(t){throw console.error("Error creating location:",t),c.value="Failed to create location. Please try again.",t}},F=async(e,t)=>{try{await l.updateLocation(e,t),await i(),d()}catch(n){throw console.error("Error updating location:",n),c.value="Failed to update location. Please try again.",n}},R=async e=>{try{await l.deleteLocation(e),await i(),d()}catch(t){throw console.error("Error deleting location:",t),c.value="Failed to delete location. Please try again.",t}},x=()=>{a.value?a.value==="unassigned"?o.value=r.value.filter(e=>!e.route):o.value=r.value.filter(e=>e.route===a.value):o.value=r.value},d=()=>{a.value="",o.value=r.value},C=()=>{a.value="",u.value="",o.value=r.value},M=e=>{if(!e||!e.address)return;const n=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e.address)}`;window.open(n,"_blank")};return P(i),{locations:o,allLocations:r,machines:v,loading:f,error:c,selectedRoute:a,availableRoutes:p,locationSearchText:u,machineTypeColors:h,locationMachines:w,filteredLocations:m,routes:L,fetchLocations:i,fetchRoutes:y,createLocation:E,updateLocation:F,deleteLocation:R,applyRouteFilter:x,clearRouteFilter:d,resetFilters:C,openMapForLocation:M}}export{T as u};
