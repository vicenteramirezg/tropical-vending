import{a as V}from"./api-BDI7RR6G.js";import{r as D,a as ot,c as P,b as v,o as p,d as t,e as E,w as q,v as O,f as et,F as B,g as z,t as s,h as I,i as rt,j as tt,n as M,k as st,l as nt,m as at,p as U,q as it,s as lt,u as Y,x as h}from"./index-CbGJeSZD.js";import{_ as dt}from"./_plugin-vue_export-helper-DlAUqK2U.js";function ct(){const l=D(!0),x=D(null),a=D([]),r=D([]),u=D([]),_=D({locations:!1,machines:!1,products:!1,analytics:!1}),g=D({summary:{total_demand_units:0,total_revenue:0,total_profit:0,avg_daily_demand:0,overall_profit_margin:0,total_restocks:0,unique_products:0,unique_machines:0,unique_locations:0},products:{top_performers:[],all:[]},machines:{top_performers:[],all:[]},locations:{performance:[]},trends:{time_series:[],daily_summary:[]},insights:[],locations_count:0,machines_count:0,products_count:0,low_stock_items:[],low_stock_count:0,recent_restocks:0,revenue_total:0,profit_total:0,profit_margin:0}),w=ot({timeRange:"30",location:"",machine:"",product:"",startDate:"",endDate:""}),F=P(()=>Object.values(_.value).some(d=>d)||l.value),f=P(()=>g.value.locations_count>0||g.value.machines_count>0||g.value.products_count>0),n=()=>{const d={};return w.startDate&&w.endDate?(d.start_date=w.startDate,d.end_date=w.endDate):w.timeRange&&(d.days=w.timeRange),w.location&&(d.location=w.location),w.machine&&(d.machine=w.machine),w.product&&(d.product=w.product),d},e=async()=>{if(!(a.value.length>0)){_.value.locations=!0;try{const d=await V.getLocations();a.value=d.data.results||d.data}catch(d){console.error("Error fetching locations:",d)}finally{_.value.locations=!1}}},o=async()=>{if(!(r.value.length>0)){_.value.machines=!0;try{const d=await V.getMachines();r.value=d.data.results||d.data}catch(d){console.error("Error fetching machines:",d)}finally{_.value.machines=!1}}},i=async()=>{if(!(u.value.length>0)){_.value.products=!0;try{const d=await V.getProducts();u.value=d.data.results||d.data}catch(d){console.error("Error fetching products:",d)}finally{_.value.products=!1}}},$=async d=>{var b,L,j,N,S,T,K;_.value.analytics=!0;try{const R=(await V.getAdvancedAnalytics(d)).data;g.value={...g.value,summary:R.summary||g.value.summary,products:R.products||g.value.products,machines:R.machines||g.value.machines,locations:R.locations||g.value.locations,trends:R.trends||g.value.trends,insights:R.insights||[],locations_count:((b=R.summary)==null?void 0:b.unique_locations)||0,machines_count:((L=R.summary)==null?void 0:L.unique_machines)||0,products_count:((j=R.summary)==null?void 0:j.unique_products)||0,low_stock_items:[],low_stock_count:0,recent_restocks:((N=R.summary)==null?void 0:N.total_restocks)||0,revenue_total:((S=R.summary)==null?void 0:S.total_revenue)||0,profit_total:((T=R.summary)==null?void 0:T.total_profit)||0,profit_margin:((K=R.summary)==null?void 0:K.overall_profit_margin)||0}}catch(Z){throw console.error("Error fetching advanced analytics data:",Z),new Error("Failed to load analytics data")}finally{_.value.analytics=!1}},m=async d=>{try{const b=await V.getDashboardData(d),L={low_stock_items:b.data.low_stock_items||[],low_stock_count:b.data.low_stock_count||0};g.value={...g.value,...L}}catch(b){console.error("Error fetching legacy dashboard data:",b)}},c=async()=>{l.value=!0,x.value=null;try{const d=n();await Promise.all([$(d),m(d)])}catch(d){console.error("Error applying filters:",d),x.value="Failed to load analytics data"}finally{l.value=!1}},y=async()=>{l.value=!0,x.value=null;try{const d=[e(),o(),i(),$(n()),m(n())],b=await Promise.allSettled(d),L=b.filter(j=>j.status==="rejected");L.length>0&&(console.warn(`${L.length} dashboard API calls failed:`,L.map(N=>{var S;return(S=N.reason)==null?void 0:S.message})),b[3].status==="rejected"&&(x.value="Failed to load analytics data"))}catch(d){console.error("Error initializing dashboard:",d),x.value="Failed to initialize dashboard"}finally{l.value=!1}};return{loading:l,error:x,locations:a,machines:r,products:u,data:g,filters:w,loadingStates:_,isAnyLoading:F,hasData:f,applyFilters:c,initializeDashboard:y,refreshSection:async d=>{try{switch(d){case"locations":await e();break;case"machines":await o();break;case"products":await i();break;case"analytics":await $(n());break;case"dashboard":case"legacy":await m(n());break;default:await c()}}catch(b){console.error(`Error refreshing ${d}:`,b),x.value=`Failed to refresh ${d} data`}},forceRefresh:async()=>{l.value=!0,x.value=null;try{V.invalidateCache&&(V.invalidateCache("/dashboard"),V.invalidateCache("/locations"),V.invalidateCache("/analytics/advanced-demand")),a.value=[],r.value=[],u.value=[],await y()}catch(d){console.error("Error force refreshing dashboard:",d),x.value="Failed to refresh dashboard data"}finally{l.value=!1}},fetchLocations:e,fetchMachines:o,fetchProducts:i,fetchAdvancedAnalyticsData:$,exportAnalyticsData:async(d="csv")=>{try{const b={...n(),format:d},L=await V.getAdvancedAnalytics(b,!0);if(d==="csv"){const N=(await V.apiClient.get("/analytics/advanced-demand/",{params:b,responseType:"blob"})).data,S=window.URL.createObjectURL(N),T=document.createElement("a");T.href=S,T.download=`analytics_report_${new Date().toISOString().split("T")[0]}.${d}`,document.body.appendChild(T),T.click(),document.body.removeChild(T),window.URL.revokeObjectURL(S)}return!0}catch(b){return console.error("Error exporting data:",b),x.value="Failed to export data",!1}},getPriorityInsights:(d=null)=>g.value.insights?d?g.value.insights.filter(b=>b.priority===d):g.value.insights:[],getTopPerformers:(d,b=5)=>{var L,j,N,S,T,K;switch(d){case"products":return((j=(L=g.value.products)==null?void 0:L.top_performers)==null?void 0:j.slice(0,b))||[];case"machines":return((S=(N=g.value.machines)==null?void 0:N.top_performers)==null?void 0:S.slice(0,b))||[];case"locations":return((K=(T=g.value.locations)==null?void 0:T.performance)==null?void 0:K.slice(0,b))||[];default:return[]}},calculatePeriodComparison:(d,b=null)=>({current:d,previous:null,change:null,changePercent:null,trend:"stable"}),getStockLevelClass:d=>d<=0?"bg-red-100 text-red-800":d<=3?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800",getTrendClass:d=>{switch(d){case"improving":return"text-green-600";case"declining":return"text-red-600";default:return"text-gray-600"}},getTrendIcon:d=>{switch(d){case"improving":return"📈";case"declining":return"📉";default:return"➡️"}}}}const ut={class:"bg-white p-4 sm:p-6 shadow-lg rounded-xl mb-6 border border-gray-100"},mt={class:"flex justify-between items-center mb-4"},xt={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4"},gt={class:"space-y-1"},ft={class:"space-y-1"},pt=["value"],yt={class:"space-y-1"},vt=["value"],ht={class:"space-y-1"},_t=["value"],bt={class:"flex items-end"},wt={class:"mt-4 pt-4 border-t border-gray-200"},$t={class:"flex items-center space-x-4"},kt={class:"flex items-center"},Ct={key:0,class:"flex items-center space-x-2"},Mt={__name:"FilterControls",props:{filters:{type:Object,required:!0},locations:{type:Array,default:()=>[]},machines:{type:Array,default:()=>[]},products:{type:Array,default:()=>[]}},emits:["apply-filters","export-data"],setup(l){const x=D(!1);return(a,r)=>(p(),v("div",ut,[t("div",mt,[r[16]||(r[16]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Analytics Filters",-1)),t("button",{type:"button",onClick:r[0]||(r[0]=u=>a.$emit("export-data")),class:"inline-flex items-center px-3 py-1.5 border border-gray-300 text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-150"},r[15]||(r[15]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),E(" Export CSV ")]))]),t("div",xt,[t("div",gt,[r[18]||(r[18]=t("label",{for:"timeRange",class:"block text-sm font-medium text-gray-700"},"Time Period",-1)),q(t("select",{id:"timeRange","onUpdate:modelValue":r[1]||(r[1]=u=>l.filters.timeRange=u),class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 text-sm",onChange:r[2]||(r[2]=u=>a.$emit("apply-filters"))},r[17]||(r[17]=[et('<option value="7">Last 7 days</option><option value="30">Last 30 days</option><option value="60">Last 60 days</option><option value="90">Last 90 days</option><option value="365">Last year</option>',5)]),544),[[O,l.filters.timeRange]])]),t("div",ft,[r[20]||(r[20]=t("label",{for:"location",class:"block text-sm font-medium text-gray-700"},"Location",-1)),q(t("select",{id:"location","onUpdate:modelValue":r[3]||(r[3]=u=>l.filters.location=u),class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 text-sm",onChange:r[4]||(r[4]=u=>a.$emit("apply-filters"))},[r[19]||(r[19]=t("option",{value:""},"All Locations",-1)),(p(!0),v(B,null,z(l.locations,u=>(p(),v("option",{key:u.id,value:u.id},s(u.name),9,pt))),128))],544),[[O,l.filters.location]])]),t("div",yt,[r[22]||(r[22]=t("label",{for:"machine",class:"block text-sm font-medium text-gray-700"},"Machine",-1)),q(t("select",{id:"machine","onUpdate:modelValue":r[5]||(r[5]=u=>l.filters.machine=u),class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 text-sm",onChange:r[6]||(r[6]=u=>a.$emit("apply-filters"))},[r[21]||(r[21]=t("option",{value:""},"All Machines",-1)),(p(!0),v(B,null,z(l.machines,u=>(p(),v("option",{key:u.id,value:u.id},s(u.name||`${u.machine_type} ${u.model}`),9,vt))),128))],544),[[O,l.filters.machine]])]),t("div",ht,[r[24]||(r[24]=t("label",{for:"product",class:"block text-sm font-medium text-gray-700"},"Product",-1)),q(t("select",{id:"product","onUpdate:modelValue":r[7]||(r[7]=u=>l.filters.product=u),class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 text-sm",onChange:r[8]||(r[8]=u=>a.$emit("apply-filters"))},[r[23]||(r[23]=t("option",{value:""},"All Products",-1)),(p(!0),v(B,null,z(l.products,u=>(p(),v("option",{key:u.id,value:u.id},s(u.name),9,_t))),128))],544),[[O,l.filters.product]])]),t("div",bt,[t("button",{type:"button",onClick:r[9]||(r[9]=u=>a.$emit("apply-filters")),class:"w-full inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-150"},r[25]||(r[25]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1),E(" Apply ")]))])]),t("div",wt,[t("div",$t,[t("label",kt,[q(t("input",{type:"checkbox","onUpdate:modelValue":r[10]||(r[10]=u=>x.value=u),class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[rt,x.value]]),r[26]||(r[26]=t("span",{class:"ml-2 text-sm text-gray-700"},"Custom date range",-1))]),x.value?(p(),v("div",Ct,[q(t("input",{type:"date","onUpdate:modelValue":r[11]||(r[11]=u=>l.filters.startDate=u),class:"border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 text-sm",onChange:r[12]||(r[12]=u=>a.$emit("apply-filters"))},null,544),[[tt,l.filters.startDate]]),r[27]||(r[27]=t("span",{class:"text-sm text-gray-500"},"to",-1)),q(t("input",{type:"date","onUpdate:modelValue":r[13]||(r[13]=u=>l.filters.endDate=u),class:"border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 text-sm",onChange:r[14]||(r[14]=u=>a.$emit("apply-filters"))},null,544),[[tt,l.filters.endDate]])])):I("",!0)])])]))}},Ft={class:"grid grid-cols-1 gap-4 sm:gap-5 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 mb-8"},Pt={class:"bg-gradient-to-br from-blue-500 to-blue-600 overflow-hidden shadow-lg rounded-xl transition-all duration-300 hover:scale-105 hover:shadow-xl"},Lt={class:"px-4 py-5 sm:p-6 text-white"},Rt={class:"mt-2 text-2xl sm:text-3xl font-bold"},Dt={class:"mt-1 text-xs text-blue-100"},jt={class:"bg-gradient-to-br from-green-500 to-green-600 overflow-hidden shadow-lg rounded-xl transition-all duration-300 hover:scale-105 hover:shadow-xl"},At={class:"px-4 py-5 sm:p-6 text-white"},St={class:"mt-2 text-2xl sm:text-3xl font-bold"},Tt={class:"mt-1 text-xs text-green-100"},Vt={class:"bg-gradient-to-br from-emerald-500 to-emerald-600 overflow-hidden shadow-lg rounded-xl transition-all duration-300 hover:scale-105 hover:shadow-xl"},Et={class:"px-4 py-5 sm:p-6 text-white"},Bt={class:"mt-2 text-2xl sm:text-3xl font-bold"},It={class:"mt-1 text-xs text-emerald-100"},Nt={class:"bg-gradient-to-br from-purple-500 to-purple-600 overflow-hidden shadow-lg rounded-xl transition-all duration-300 hover:scale-105 hover:shadow-xl"},zt={class:"px-4 py-5 sm:p-6 text-white"},qt={class:"mt-2 text-2xl sm:text-3xl font-bold"},Ut={class:"mt-1 text-xs text-purple-100"},Kt={class:"bg-gradient-to-br from-orange-500 to-orange-600 overflow-hidden shadow-lg rounded-xl transition-all duration-300 hover:scale-105 hover:shadow-xl"},Ot={class:"px-4 py-5 sm:p-6 text-white"},Ht={class:"mt-2 text-2xl sm:text-3xl font-bold"},Gt={class:"mt-1 text-xs text-orange-100"},Wt={key:0,class:"bg-white shadow-lg rounded-xl mb-6 overflow-hidden"},Jt={class:"p-6"},Qt={class:"space-y-4"},Xt={class:"flex-shrink-0 mr-3"},Yt={class:"flex-1 min-w-0"},Zt={class:"text-sm font-semibold text-gray-900"},te={class:"text-sm text-gray-600 mt-1"},ee={class:"flex-shrink-0 ml-4"},se={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},oe={__name:"KpiCards",props:{data:{type:Object,required:!0}},setup(l){const x=l,a=f=>f>=1e6?(f/1e6).toFixed(1)+"M":f>=1e3?(f/1e3).toFixed(1)+"K":f.toString(),r=f=>f>=1e6?(f/1e6).toFixed(1)+"M":f>=1e3?(f/1e3).toFixed(1)+"K":f.toFixed(2),u=f=>{if(typeof f=="number"){if(f>=1e3)return a(f);if(f%1!==0)return f.toFixed(1)}return f.toString()},_=P(()=>{if(!x.data.insights)return[];const f={high:1,medium:2,low:3};return x.data.insights.slice(0,3).sort((n,e)=>f[n.priority]-f[e.priority])}),g=f=>{switch(f){case"high":return"bg-red-50 border-l-4 border-red-400";case"medium":return"bg-yellow-50 border-l-4 border-yellow-400";default:return"bg-blue-50 border-l-4 border-blue-400"}},w=f=>{switch(f){case"high":return"bg-red-500";case"medium":return"bg-yellow-500";default:return"bg-blue-500"}},F=f=>{switch(f){case"high":return"!";case"medium":return"⚠";default:return"ℹ"}};return(f,n)=>{var e,o,i,$,m,c,y,k,C;return p(),v(B,null,[t("div",Ft,[t("div",Pt,[t("div",Lt,[t("dl",null,[n[0]||(n[0]=t("dt",{class:"text-sm font-medium text-blue-100 truncate"},"Units Sold",-1)),t("dd",Rt,s(a(((e=l.data.summary)==null?void 0:e.total_demand_units)||0)),1),t("dd",Dt,s(a(((o=l.data.summary)==null?void 0:o.avg_daily_demand)||0))+"/day avg",1)])])]),t("div",jt,[t("div",At,[t("dl",null,[n[1]||(n[1]=t("dt",{class:"text-sm font-medium text-green-100 truncate"},"Total Revenue",-1)),t("dd",St,"$"+s(r(((i=l.data.summary)==null?void 0:i.total_revenue)||0)),1),t("dd",Tt,s((($=l.data.summary)==null?void 0:$.total_restocks)||0)+" restocks",1)])])]),t("div",Vt,[t("div",Et,[t("dl",null,[n[2]||(n[2]=t("dt",{class:"text-sm font-medium text-emerald-100 truncate"},"Total Profit",-1)),t("dd",Bt,"$"+s(r(((m=l.data.summary)==null?void 0:m.total_profit)||0)),1),t("dd",It,s((((c=l.data.summary)==null?void 0:c.overall_profit_margin)||0).toFixed(1))+"% margin",1)])])]),t("div",Nt,[t("div",zt,[t("dl",null,[n[3]||(n[3]=t("dt",{class:"text-sm font-medium text-purple-100 truncate"},"Active Products",-1)),t("dd",qt,s(((y=l.data.summary)==null?void 0:y.unique_products)||0),1),t("dd",Ut,s(((k=l.data.summary)==null?void 0:k.unique_machines)||0)+" machines",1)])])]),t("div",Kt,[t("div",Ot,[t("dl",null,[n[4]||(n[4]=t("dt",{class:"text-sm font-medium text-orange-100 truncate"},"Locations",-1)),t("dd",Ht,s(((C=l.data.summary)==null?void 0:C.unique_locations)||0),1),t("dd",Gt,s(l.data.low_stock_count||0)+" low stock",1)])])])]),l.data.insights&&l.data.insights.length>0?(p(),v("div",Wt,[n[5]||(n[5]=t("div",{class:"px-6 py-4 bg-gradient-to-r from-indigo-500 to-purple-600"},[t("h3",{class:"text-lg font-semibold text-white flex items-center"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})]),E(" Key Insights ")])],-1)),t("div",Jt,[t("div",Qt,[(p(!0),v(B,null,z(_.value,A=>(p(),v("div",{key:A.type,class:M(["flex items-start p-4 rounded-lg",g(A.priority)])},[t("div",Xt,[t("div",{class:M(["w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-bold",w(A.priority)])},s(F(A.priority)),3)]),t("div",Yt,[t("h4",Zt,s(A.title),1),t("p",te,s(A.description),1)]),t("div",ee,[t("span",se,s(u(A.metric)),1)])],2))),128))])])])):I("",!0)],64)}}},re={class:"bg-white shadow-lg rounded-xl mb-6 overflow-hidden"},ne={class:"px-6 py-5 border-b border-gray-200"},ae={class:"flex justify-between items-center"},ie={class:"flex space-x-2"},le={class:"overflow-hidden"},de={class:"overflow-x-auto"},ce={class:"min-w-full divide-y divide-gray-200"},ue={class:"bg-white divide-y divide-gray-200"},me={class:"px-6 py-4 whitespace-nowrap"},xe={class:"flex items-center"},ge={class:"flex-shrink-0 w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center"},fe={class:"text-xs font-semibold text-primary-800"},pe={class:"ml-3"},ye={class:"text-sm font-semibold text-gray-900"},ve={class:"text-xs text-gray-500"},he={class:"px-6 py-4 whitespace-nowrap"},_e={class:"text-sm font-semibold text-gray-900"},be={class:"text-xs text-gray-500"},we={class:"px-6 py-4 whitespace-nowrap"},$e={class:"text-sm font-semibold text-gray-900"},ke={class:"text-xs text-gray-500"},Ce={class:"px-6 py-4 whitespace-nowrap"},Me={class:"text-sm font-semibold text-gray-900"},Fe={class:"text-xs text-gray-500"},Pe={class:"px-6 py-4 whitespace-nowrap"},Le={class:"flex items-center"},Re={class:"px-6 py-4 whitespace-nowrap"},De={class:"flex items-center"},je={class:"w-16 bg-gray-200 rounded-full h-2 mr-2"},Ae={class:"text-xs text-gray-600"},Se={class:"px-6 py-4 whitespace-nowrap"},Te={class:"mr-1"},Ve={key:0,class:"text-center py-12"},Ee={__name:"ProductPerformance",props:{products:{type:Array,default:()=>[]}},setup(l){const x=l,a=D("demand"),r=P(()=>{if(!x.products||x.products.length===0)return[];const n=[...x.products];switch(a.value){case"demand":return n.sort((e,o)=>o.total_demand-e.total_demand);case"revenue":return n.sort((e,o)=>o.total_revenue-e.total_revenue);case"margin":return n.sort((e,o)=>o.profit_margin-e.profit_margin);default:return n}}),u=n=>n>=1e6?(n/1e6).toFixed(1)+"M":n>=1e3?(n/1e3).toFixed(1)+"K":Math.round(n).toString(),_=n=>n>=1e6?(n/1e6).toFixed(1)+"M":n>=1e3?(n/1e3).toFixed(1)+"K":n.toFixed(2),g=n=>n>=50?"text-green-600":n>=25?"text-yellow-600":n>=0?"text-gray-600":"text-red-600",w=n=>n>=2?"bg-green-500":n>=1?"bg-yellow-500":"bg-red-500",F=n=>{switch(n){case"improving":return"bg-green-100 text-green-800";case"declining":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},f=n=>{switch(n){case"improving":return"📈";case"declining":return"📉";default:return"➡️"}};return(n,e)=>(p(),v("div",re,[t("div",ne,[t("div",ae,[e[3]||(e[3]=t("div",null,[t("h3",{class:"text-lg leading-6 font-semibold text-gray-900"},"Top Product Performance"),t("p",{class:"mt-1 text-sm text-gray-500"}," Products ranked by demand and profitability ")],-1)),t("div",ie,[t("button",{onClick:e[0]||(e[0]=o=>a.value="demand"),class:M(["px-3 py-1.5 text-xs font-medium rounded-md transition-colors",a.value==="demand"?"bg-primary-100 text-primary-800":"text-gray-600 hover:text-gray-900"])}," By Demand ",2),t("button",{onClick:e[1]||(e[1]=o=>a.value="revenue"),class:M(["px-3 py-1.5 text-xs font-medium rounded-md transition-colors",a.value==="revenue"?"bg-primary-100 text-primary-800":"text-gray-600 hover:text-gray-900"])}," By Revenue ",2),t("button",{onClick:e[2]||(e[2]=o=>a.value="margin"),class:M(["px-3 py-1.5 text-xs font-medium rounded-md transition-colors",a.value==="margin"?"bg-primary-100 text-primary-800":"text-gray-600 hover:text-gray-900"])}," By Margin ",2)])])]),t("div",le,[t("div",de,[t("table",ce,[e[4]||(e[4]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Product"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Demand"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Revenue"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Profit"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Margin"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Coverage"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Trend")])],-1)),t("tbody",ue,[(p(!0),v(B,null,z(r.value,(o,i)=>(p(),v("tr",{key:o.product_id,class:"hover:bg-gray-50 transition-colors duration-150"},[t("td",me,[t("div",xe,[t("div",ge,[t("span",fe,s(i+1),1)]),t("div",pe,[t("div",ye,s(o.product_name),1),t("div",ve,s(o.machines_count)+" machines • "+s(o.locations_count)+" locations",1)])])]),t("td",he,[t("div",_e,s(u(o.total_demand)),1),t("div",be,s(o.restock_count)+" restocks",1)]),t("td",we,[t("div",$e,"$"+s(_(o.total_revenue)),1),t("div",ke,"$"+s(_(o.avg_revenue_per_restock||0))+"/restock",1)]),t("td",Ce,[t("div",Me,"$"+s(_(o.total_profit)),1),t("div",Fe,s(u(o.avg_demand_per_restock||0))+" units/restock",1)]),t("td",Pe,[t("div",Le,[t("span",{class:M(["text-sm font-semibold",g(o.profit_margin)])},s((o.profit_margin||0).toFixed(1))+"% ",3)])]),t("td",Re,[t("div",De,[t("div",je,[t("div",{class:M(["h-2 rounded-full",w(o.velocity_score)]),style:st({width:`${Math.min(100,(o.velocity_score||0)*20)}%`})},null,6)]),t("span",Ae,s((o.velocity_score||0).toFixed(2)),1)])]),t("td",Se,[t("span",{class:M(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",F(o.performance_trend)])},[t("span",Te,s(f(o.performance_trend)),1),E(" "+s(o.performance_trend),1)],2)])]))),128))])])])]),!l.products||l.products.length===0?(p(),v("div",Ve,e[5]||(e[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1),t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No product data",-1),t("p",{class:"mt-1 text-sm text-gray-500"},"No analytics data available for the selected time period.",-1)]))):I("",!0)]))}},Be={class:"bg-white shadow-lg rounded-xl mb-6 overflow-hidden"},Ie={class:"px-6 py-5 border-b border-gray-200"},Ne={class:"flex justify-between items-center"},ze={class:"flex space-x-2"},qe={class:"overflow-hidden"},Ue={class:"overflow-x-auto"},Ke={class:"min-w-full divide-y divide-gray-200"},Oe={class:"bg-white divide-y divide-gray-200"},He={class:"px-6 py-4 whitespace-nowrap"},Ge={class:"flex items-center"},We={class:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center"},Je={class:"text-xs font-semibold text-blue-800"},Qe={class:"ml-3"},Xe={class:"text-sm font-semibold text-gray-900"},Ye={class:"text-xs text-gray-500"},Ze={class:"px-6 py-4 whitespace-nowrap"},ts={class:"text-sm text-gray-900"},es={class:"px-6 py-4 whitespace-nowrap"},ss={class:"text-sm font-semibold text-gray-900"},os={class:"text-xs text-gray-500"},rs={class:"px-6 py-4 whitespace-nowrap"},ns={class:"text-sm font-semibold text-gray-900"},as={class:"text-xs text-gray-500"},is={class:"px-6 py-4 whitespace-nowrap"},ls={class:"text-sm font-semibold text-gray-900"},ds={class:"text-xs text-gray-500"},cs={class:"px-6 py-4 whitespace-nowrap"},us={class:"flex items-center"},ms={class:"flex-shrink-0"},xs={class:"ml-2"},gs={class:"text-sm font-semibold text-gray-900"},fs={class:"px-6 py-4 whitespace-nowrap"},ps={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},ys={class:"bg-gray-50 px-6 py-4"},vs={class:"grid grid-cols-1 md:grid-cols-4 gap-4 text-center"},hs={class:"text-lg font-semibold text-gray-900"},_s={class:"text-lg font-semibold text-green-600"},bs={class:"text-lg font-semibold text-blue-600"},ws={class:"text-lg font-semibold text-purple-600"},$s={key:0,class:"text-center py-12"},ks={__name:"MachinePerformance",props:{machines:{type:Array,default:()=>[]}},setup(l){const x=l,a=D("efficiency"),r=P(()=>{if(!x.machines||x.machines.length===0)return[];const e=[...x.machines];switch(a.value){case"efficiency":return e.sort((o,i)=>(i.efficiency_score||0)-(o.efficiency_score||0));case"demand":return e.sort((o,i)=>i.total_demand-o.total_demand);case"revenue":return e.sort((o,i)=>i.total_revenue-o.total_revenue);default:return e}}),u=P(()=>{var e;return((e=x.machines)==null?void 0:e.reduce((o,i)=>o+i.total_revenue,0))||0}),_=P(()=>{if(!x.machines||x.machines.length===0)return 0;const e=x.machines.filter(o=>o.efficiency_score>0);return e.length===0?0:e.reduce((o,i)=>o+i.efficiency_score,0)/e.length}),g=P(()=>{var e;return((e=x.machines)==null?void 0:e.filter(o=>o.efficiency_score>_.value).length)||0}),w=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":Math.round(e).toString(),F=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toFixed(2),f=e=>e>=1e3?"bg-green-500":e>=500?"bg-yellow-500":e>=100?"bg-orange-500":"bg-red-500",n=e=>e>=1e3?"A+":e>=500?"A":e>=300?"B":e>=150?"C":e>=50?"D":"F";return(e,o)=>(p(),v("div",Be,[t("div",Ie,[t("div",Ne,[o[3]||(o[3]=t("div",null,[t("h3",{class:"text-lg leading-6 font-semibold text-gray-900"},"Machine Performance"),t("p",{class:"mt-1 text-sm text-gray-500"}," Machine efficiency and revenue generation ")],-1)),t("div",ze,[t("button",{onClick:o[0]||(o[0]=i=>a.value="efficiency"),class:M(["px-3 py-1.5 text-xs font-medium rounded-md transition-colors",a.value==="efficiency"?"bg-primary-100 text-primary-800":"text-gray-600 hover:text-gray-900"])}," Efficiency ",2),t("button",{onClick:o[1]||(o[1]=i=>a.value="demand"),class:M(["px-3 py-1.5 text-xs font-medium rounded-md transition-colors",a.value==="demand"?"bg-primary-100 text-primary-800":"text-gray-600 hover:text-gray-900"])}," Demand ",2),t("button",{onClick:o[2]||(o[2]=i=>a.value="revenue"),class:M(["px-3 py-1.5 text-xs font-medium rounded-md transition-colors",a.value==="revenue"?"bg-primary-100 text-primary-800":"text-gray-600 hover:text-gray-900"])}," Revenue ",2)])])]),t("div",qe,[t("div",Ue,[t("table",Ke,[o[5]||(o[5]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Machine"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Location"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Demand"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Revenue"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Profit"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Efficiency"),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Products")])],-1)),t("tbody",Oe,[(p(!0),v(B,null,z(r.value,(i,$)=>(p(),v("tr",{key:i.machine_id,class:"hover:bg-gray-50 transition-colors duration-150"},[t("td",He,[t("div",Ge,[t("div",We,[t("span",Je,s($+1),1)]),t("div",Qe,[t("div",Xe,s(i.machine_name),1),t("div",Ye,s(i.machine_type)+" "+s(i.machine_model),1)])])]),t("td",Ze,[t("div",ts,s(i.location_name),1)]),t("td",es,[t("div",ss,s(w(i.total_demand)),1),t("div",os,s(w(i.avg_demand_per_restock||0))+"/restock",1)]),t("td",rs,[t("div",ns,"$"+s(F(i.total_revenue)),1),t("div",as,s(i.restock_count)+" restocks",1)]),t("td",is,[t("div",ls,"$"+s(F(i.total_profit)),1),t("div",ds,s(i.total_revenue>0?(i.total_profit/i.total_revenue*100).toFixed(1):0)+"% margin ",1)]),t("td",cs,[t("div",us,[t("div",ms,[t("div",{class:M(["w-8 h-8 rounded-full flex items-center justify-center text-xs font-semibold text-white",f(i.efficiency_score)])},s(n(i.efficiency_score)),3)]),t("div",xs,[t("div",gs,"$"+s(F(i.efficiency_score||0)),1),o[4]||(o[4]=t("div",{class:"text-xs text-gray-500"},"per restock",-1))])])]),t("td",fs,[t("span",ps,s(i.product_count)+" products ",1)])]))),128))])])])]),t("div",ys,[t("div",vs,[t("div",null,[t("div",hs,s(l.machines.length),1),o[6]||(o[6]=t("div",{class:"text-sm text-gray-500"},"Total Machines",-1))]),t("div",null,[t("div",_s," $"+s(F(u.value)),1),o[7]||(o[7]=t("div",{class:"text-sm text-gray-500"},"Total Revenue",-1))]),t("div",null,[t("div",bs," $"+s(F(_.value)),1),o[8]||(o[8]=t("div",{class:"text-sm text-gray-500"},"Avg Efficiency",-1))]),t("div",null,[t("div",ws,s(g.value),1),o[9]||(o[9]=t("div",{class:"text-sm text-gray-500"},"High Performers",-1))])])]),!l.machines||l.machines.length===0?(p(),v("div",$s,o[10]||(o[10]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 7.172V5L8 4z"})],-1),t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No machine data",-1),t("p",{class:"mt-1 text-sm text-gray-500"},"No analytics data available for the selected time period.",-1)]))):I("",!0)]))}},Cs={class:"bg-white shadow-lg rounded-xl mb-6 overflow-hidden"},Ms={class:"px-6 py-5 border-b border-gray-200"},Fs={class:"flex justify-between items-center"},Ps={class:"flex space-x-2"},Ls={class:"p-6"},Rs={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Ds={class:"absolute -top-2 -left-2 w-6 h-6 bg-primary-600 text-white rounded-full flex items-center justify-center text-xs font-bold"},js={class:"mb-4"},As={class:"text-lg font-semibold text-gray-900"},Ss={class:"text-sm text-gray-500"},Ts={class:"space-y-3"},Vs={class:"text-center py-3 bg-white rounded-lg border"},Es={class:"text-xs text-gray-600"},Bs={class:"grid grid-cols-2 gap-2 text-center"},Is={class:"p-2 bg-green-50 rounded"},Ns={class:"text-sm font-semibold text-green-800"},zs={class:"p-2 bg-blue-50 rounded"},qs={class:"text-sm font-semibold text-blue-800"},Us={class:"grid grid-cols-2 gap-2 text-center"},Ks={class:"p-2 bg-purple-50 rounded"},Os={class:"text-sm font-semibold text-purple-800"},Hs={class:"p-2 bg-orange-50 rounded"},Gs={class:"text-sm font-semibold text-orange-800"},Ws={class:"mt-4"},Js={class:"flex justify-between items-center mb-1"},Qs={class:"text-xs font-medium text-gray-900"},Xs={class:"w-full bg-gray-200 rounded-full h-2"},Ys={class:"bg-gray-50 px-6 py-4 border-t"},Zs={class:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center"},to={class:"text-lg font-semibold text-gray-900"},eo={class:"text-lg font-semibold text-green-600"},so={class:"text-lg font-semibold text-blue-600"},oo={class:"text-lg font-semibold text-purple-600"},ro={key:0,class:"text-center py-12"},no={__name:"LocationPerformance",props:{locations:{type:Array,default:()=>[]}},setup(l){const x=l,a=D("revenue"),r=P(()=>{if(!x.locations||x.locations.length===0)return[];const m=[...x.locations];switch(a.value){case"revenue":return m.sort((c,y)=>y.total_revenue-c.total_revenue);case"demand":return m.sort((c,y)=>y.total_demand-c.total_demand);case"efficiency":return m.sort((c,y)=>y.avg_revenue_per_machine-c.avg_revenue_per_machine);default:return m}}),u=P(()=>{var m;return((m=x.locations)==null?void 0:m.reduce((c,y)=>c+y.total_revenue,0))||0}),_=P(()=>{var m;return((m=x.locations)==null?void 0:m.reduce((c,y)=>c+y.machine_count,0))||0}),g=P(()=>!x.locations||x.locations.length===0?0:u.value/x.locations.length),w=P(()=>{var m;return((m=x.locations)==null?void 0:m.filter(c=>c.total_revenue>g.value).length)||0}),F=m=>m>=1e6?(m/1e6).toFixed(1)+"M":m>=1e3?(m/1e3).toFixed(1)+"K":Math.round(m).toString(),f=m=>m>=1e6?(m/1e6).toFixed(1)+"M":m>=1e3?(m/1e3).toFixed(1)+"K":m.toFixed(2),n=m=>{switch(a.value){case"revenue":return"$"+f(m.total_revenue);case"demand":return F(m.total_demand);case"efficiency":return"$"+f(m.avg_revenue_per_machine||0);default:return"$"+f(m.total_revenue)}},e=()=>{switch(a.value){case"revenue":return"Total Revenue";case"demand":return"Total Demand";case"efficiency":return"Revenue/Machine";default:return"Total Revenue"}},o=m=>m===0?"text-yellow-600":m===1?"text-gray-600":m===2?"text-orange-600":"text-primary-600",i=m=>{var y;const c=Math.max(...((y=x.locations)==null?void 0:y.map(k=>k.total_revenue))||[1]);return m.total_revenue/c*100},$=m=>{const c=i(m);return c>=80?"bg-green-500":c>=60?"bg-yellow-500":c>=40?"bg-orange-500":"bg-red-500"};return(m,c)=>(p(),v("div",Cs,[t("div",Ms,[t("div",Fs,[c[3]||(c[3]=t("div",null,[t("h3",{class:"text-lg leading-6 font-semibold text-gray-900"},"Location Performance"),t("p",{class:"mt-1 text-sm text-gray-500"}," Revenue and demand by location ")],-1)),t("div",Ps,[t("button",{onClick:c[0]||(c[0]=y=>a.value="revenue"),class:M(["px-3 py-1.5 text-xs font-medium rounded-md transition-colors",a.value==="revenue"?"bg-primary-100 text-primary-800":"text-gray-600 hover:text-gray-900"])}," Revenue ",2),t("button",{onClick:c[1]||(c[1]=y=>a.value="demand"),class:M(["px-3 py-1.5 text-xs font-medium rounded-md transition-colors",a.value==="demand"?"bg-primary-100 text-primary-800":"text-gray-600 hover:text-gray-900"])}," Demand ",2),t("button",{onClick:c[2]||(c[2]=y=>a.value="efficiency"),class:M(["px-3 py-1.5 text-xs font-medium rounded-md transition-colors",a.value==="efficiency"?"bg-primary-100 text-primary-800":"text-gray-600 hover:text-gray-900"])}," Per Machine ",2)])])]),t("div",Ls,[t("div",Rs,[(p(!0),v(B,null,z(r.value,(y,k)=>(p(),v("div",{key:y.location_id,class:"relative bg-gradient-to-br from-gray-50 to-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-all duration-200"},[t("div",Ds,s(k+1),1),t("div",js,[t("h4",As,s(y.location_name),1),t("p",Ss,s(y.machine_count)+" machines • "+s(y.product_count)+" products ",1)]),t("div",Ts,[t("div",Vs,[t("div",{class:M(["text-2xl font-bold",o(k)])},s(n(y)),3),t("div",Es,s(e()),1)]),t("div",Bs,[t("div",Is,[t("div",Ns," $"+s(f(y.total_revenue)),1),c[4]||(c[4]=t("div",{class:"text-xs text-green-600"},"Revenue",-1))]),t("div",zs,[t("div",qs,s(F(y.total_demand)),1),c[5]||(c[5]=t("div",{class:"text-xs text-blue-600"},"Demand",-1))])]),t("div",Us,[t("div",Ks,[t("div",Os," $"+s(f(y.total_profit)),1),c[6]||(c[6]=t("div",{class:"text-xs text-purple-600"},"Profit",-1))]),t("div",Hs,[t("div",Gs,s(y.restock_count),1),c[7]||(c[7]=t("div",{class:"text-xs text-orange-600"},"Restocks",-1))])])]),t("div",Ws,[t("div",Js,[c[8]||(c[8]=t("span",{class:"text-xs text-gray-600"},"Performance",-1)),t("span",Qs,s(i(y).toFixed(1))+"% ",1)]),t("div",Xs,[t("div",{class:M(["h-2 rounded-full transition-all duration-500",$(y)]),style:st({width:`${Math.min(100,i(y))}%`})},null,6)])])]))),128))])]),t("div",Ys,[t("div",Zs,[t("div",null,[t("div",to,s(l.locations.length),1),c[9]||(c[9]=t("div",{class:"text-sm text-gray-500"},"Locations",-1))]),t("div",null,[t("div",eo," $"+s(f(u.value)),1),c[10]||(c[10]=t("div",{class:"text-sm text-gray-500"},"Total Revenue",-1))]),t("div",null,[t("div",so,s(_.value),1),c[11]||(c[11]=t("div",{class:"text-sm text-gray-500"},"Total Machines",-1))]),t("div",null,[t("div",oo,s(w.value),1),c[12]||(c[12]=t("div",{class:"text-sm text-gray-500"},"Top Performers",-1))])])]),!l.locations||l.locations.length===0?(p(),v("div",ro,c[13]||(c[13]=[et('<svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mx-auto text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg><h3 class="mt-2 text-sm font-medium text-gray-900">No location data</h3><p class="mt-1 text-sm text-gray-500">No analytics data available for the selected time period.</p>',3)]))):I("",!0)]))}},ao={class:"bg-white shadow-lg overflow-hidden sm:rounded-xl mb-8 transition-all duration-300 hover:shadow-xl"},io={class:"px-6 py-5 border-b border-gray-100 flex justify-between items-center"},lo={class:"mt-1 text-sm text-gray-500"},co={key:0,class:"text-gray-400"},uo={class:"flex items-center space-x-3"},mo={key:0,class:"px-6 py-8 text-center text-gray-500"},xo={key:1},go={role:"list",class:"divide-y divide-gray-200"},fo={class:"flex items-center justify-between"},po={class:"flex-1 min-w-0"},yo={class:"flex items-center"},vo={class:"flex-shrink-0"},ho={class:"ml-3 min-w-0 flex-1"},_o={class:"text-sm font-medium text-primary-600 truncate"},bo={class:"text-sm text-gray-500 truncate"},wo={class:"flex items-center space-x-2"},$o={class:"text-right"},ko={class:"text-sm font-medium text-gray-900"},Co={key:0,class:"bg-gray-50 px-6 py-3 border-t border-gray-200"},Mo={class:"flex items-center justify-between"},Fo={class:"flex items-center space-x-2"},Po={class:"text-sm text-gray-700"},Lo={class:"flex items-center space-x-1"},Ro=["disabled"],Do=["disabled"],jo={class:"flex space-x-1"},Ao=["onClick"],So=["disabled"],To=["disabled"],Vo={__name:"LowStockItems",props:{data:{type:Object,required:!0},getStockLevelClass:{type:Function,required:!0}},setup(l){const x=l,a=D(1),r=D(10);nt(()=>x.data.low_stock_items,()=>{a.value=1});const u=P(()=>{var n;return Math.ceil((((n=x.data.low_stock_items)==null?void 0:n.length)||0)/r.value)}),_=P(()=>(a.value-1)*r.value),g=P(()=>{var n;return Math.min(_.value+r.value,((n=x.data.low_stock_items)==null?void 0:n.length)||0)}),w=P(()=>x.data.low_stock_items?x.data.low_stock_items.slice(_.value,g.value):[]),F=P(()=>{const n=u.value,e=a.value,o=2,i=[],$=[];for(let m=Math.max(2,e-o);m<=Math.min(n-1,e+o);m++)i.push(m);return e-o>2?$.push(1,"..."):$.push(1),$.push(...i),e+o<n-1?$.push("...",n):n>1&&$.push(n),$.filter((m,c,y)=>!(m===1&&c>0&&y[c-1]===1||m===n&&c<y.length-1&&y[c+1]===n)).slice(0,7)}),f=n=>n<=0?"bg-red-500":n<=3?"bg-yellow-500":"bg-blue-500";return(n,e)=>{const o=at("router-link");return p(),v("div",ao,[t("div",io,[t("div",null,[e[7]||(e[7]=t("h3",{class:"text-lg leading-6 font-medium text-gray-900"},"Low Stock Items",-1)),t("p",lo,[e[6]||(e[6]=E(" Products with stock level below threshold ")),l.data.low_stock_items.length>0?(p(),v("span",co," ("+s(_.value+1)+"-"+s(g.value)+" of "+s(l.data.low_stock_items.length)+") ",1)):I("",!0)])]),t("div",uo,[t("span",{class:M(["inline-flex items-center px-3.5 py-1 rounded-full text-sm font-medium",l.data.low_stock_count>0?"bg-red-100 text-red-800":"bg-green-100 text-green-800"])},s(l.data.low_stock_count)+" items ",3),U(o,{to:"/inventory",class:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-md text-primary-600 bg-primary-100 hover:bg-primary-200 transition-colors duration-150"},{default:it(()=>e[8]||(e[8]=[t("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),E(" Full Report ")])),_:1})])]),t("div",null,[l.data.low_stock_items.length===0?(p(),v("div",mo,e[9]||(e[9]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-12 w-12 mx-auto text-green-400 mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),t("p",{class:"text-lg font-medium"},"No low stock items - everything is well stocked!",-1)]))):(p(),v("div",xo,[t("ul",go,[(p(!0),v(B,null,z(w.value,(i,$)=>(p(),v("li",{key:$,class:"px-6 py-4 hover:bg-gray-50 transition-colors duration-150"},[t("div",fo,[t("div",po,[t("div",yo,[t("div",vo,[t("div",{class:M(["w-2 h-2 rounded-full",f(i.current_stock)])},null,2)]),t("div",ho,[t("p",_o,s(i.product),1),t("p",bo,s(i.machine)+" • "+s(i.location),1)])])]),t("div",wo,[t("div",$o,[t("div",ko,"$"+s((i.price||0).toFixed(2)),1),e[10]||(e[10]=t("div",{class:"text-xs text-gray-500"},"Price",-1))]),t("span",{class:M(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",l.getStockLevelClass(i.current_stock)])},s(i.current_stock),3)])])]))),128))]),u.value>1?(p(),v("div",Co,[t("div",Mo,[t("div",Fo,[t("span",Po," Page "+s(a.value)+" of "+s(u.value),1),q(t("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>r.value=i),onChange:e[1]||(e[1]=i=>a.value=1),class:"text-sm border-gray-300 rounded-md focus:ring-primary-500 focus:border-primary-500"},e[11]||(e[11]=[t("option",{value:"5"},"5 per page",-1),t("option",{value:"10"},"10 per page",-1),t("option",{value:"15"},"15 per page",-1),t("option",{value:"20"},"20 per page",-1)]),544),[[O,r.value]])]),t("nav",Lo,[t("button",{onClick:e[2]||(e[2]=i=>a.value=1),disabled:a.value===1,class:"inline-flex items-center px-2 py-1 text-xs font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," First ",8,Ro),t("button",{onClick:e[3]||(e[3]=i=>a.value--),disabled:a.value===1,class:"inline-flex items-center px-2 py-1 text-xs font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},e[12]||(e[12]=[t("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),E(" Prev ")]),8,Do),t("div",jo,[(p(!0),v(B,null,z(F.value,i=>(p(),v("button",{key:i,onClick:$=>a.value=i,class:M(["inline-flex items-center px-3 py-1 text-xs font-medium rounded-md",i===a.value?"text-white bg-primary-600 border border-primary-600":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"])},s(i),11,Ao))),128))]),t("button",{onClick:e[4]||(e[4]=i=>a.value++),disabled:a.value===u.value,class:"inline-flex items-center px-2 py-1 text-xs font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},e[13]||(e[13]=[E(" Next "),t("svg",{class:"w-3 h-3 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]),8,So),t("button",{onClick:e[5]||(e[5]=i=>a.value=u.value),disabled:a.value===u.value,class:"inline-flex items-center px-2 py-1 text-xs font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Last ",8,To)])])])):I("",!0)]))])])}}},Eo={class:"bg-white shadow-lg overflow-hidden sm:rounded-xl transition-all duration-300 hover:shadow-xl"},Bo={class:"grid grid-cols-1 md:grid-cols-3 divide-y md:divide-y-0 md:divide-x divide-gray-200"},Io={class:"px-6 py-5"},No={class:"mt-2 text-3xl font-bold text-gray-900"},zo={class:"px-6 py-5"},qo={class:"mt-2 text-3xl font-bold text-green-600"},Uo={class:"px-6 py-5"},Ko={class:"mt-2 text-3xl font-bold text-gray-900"},Oo={__name:"RevenueSummary",props:{data:{type:Object,required:!0}},setup(l){return(x,a)=>(p(),v("div",Eo,[a[3]||(a[3]=t("div",{class:"px-6 py-5 border-b border-gray-100"},[t("h3",{class:"text-lg leading-6 font-medium text-gray-900"},"Revenue & Profit"),t("p",{class:"mt-1 text-sm text-gray-500"}," Last 30 days performance ")],-1)),t("div",null,[t("div",Bo,[t("div",Io,[a[0]||(a[0]=t("div",{class:"text-sm font-medium text-gray-500"},"Total Revenue",-1)),t("div",No,"$"+s((l.data.revenue_total||0).toFixed(2)),1)]),t("div",zo,[a[1]||(a[1]=t("div",{class:"text-sm font-medium text-gray-500"},"Total Profit",-1)),t("div",qo,"$"+s((l.data.profit_total||0).toFixed(2)),1)]),t("div",Uo,[a[2]||(a[2]=t("div",{class:"text-sm font-medium text-gray-500"},"Profit Margin",-1)),t("div",Ko,s((l.data.profit_margin||0).toFixed(1))+"%",1)])])])]))}},Ho={},Go={class:"flex justify-center py-20"};function Wo(l,x){return p(),v("div",Go,x[0]||(x[0]=[t("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"},null,-1)]))}const Jo=dt(Ho,[["render",Wo]]),Qo={class:"min-h-screen flex flex-col bg-gray-50"},Xo={class:"flex-grow container mx-auto px-4 py-8"},Yo={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-6 shadow-sm"},Zo={class:"flex items-center"},tr={key:2,class:"space-y-8"},er={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},sr={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},or={class:"bg-white rounded-xl shadow-lg p-6"},rr={class:"flex justify-between items-center mb-6"},nr={class:"flex space-x-3"},ar=["disabled"],ir={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},lr={class:"text-center p-4 bg-gray-50 rounded-lg"},dr={class:"text-2xl font-bold text-primary-600"},cr={class:"text-xs text-gray-500 mt-1"},ur={class:"text-center p-4 bg-gray-50 rounded-lg"},mr={class:"text-2xl font-bold text-green-600"},xr={class:"text-xs text-gray-500 mt-1"},gr={class:"text-center p-4 bg-gray-50 rounded-lg"},fr={class:"text-2xl font-bold text-emerald-600"},pr={class:"text-xs text-gray-500 mt-1"},yr={class:"text-center p-4 bg-gray-50 rounded-lg"},vr={class:"text-2xl font-bold text-purple-600"},hr={class:"text-xs text-gray-500 mt-1"},$r={__name:"Dashboard",setup(l){const{loading:x,error:a,locations:r,machines:u,products:_,data:g,filters:w,isAnyLoading:F,applyFilters:f,initializeDashboard:n,refreshSection:e,exportAnalyticsData:o,getStockLevelClass:i}=ct(),$=k=>k>=1e6?(k/1e6).toFixed(1)+"M":k>=1e3?(k/1e3).toFixed(1)+"K":Math.round(k).toString(),m=k=>k>=1e6?(k/1e6).toFixed(1)+"M":k>=1e3?(k/1e3).toFixed(1)+"K":k.toFixed(2),c=async()=>{await o("csv")&&console.log("Export successful")},y=async()=>{await e("analytics")};return lt(()=>{n()}),(k,C)=>{var A,H,G,W,J,Q,X,d,b,L,j;return p(),v("div",Qo,[t("div",Xo,[C[8]||(C[8]=t("div",{class:"mb-8"},[t("h1",{class:"text-3xl font-bold text-gray-900"},"Analytics Dashboard"),t("p",{class:"mt-2 text-gray-600"},"Comprehensive insights into your vending business performance")],-1)),U(Mt,{filters:h(w),locations:h(r),machines:h(u),products:h(_),onApplyFilters:h(f),onExportData:c},null,8,["filters","locations","machines","products","onApplyFilters"]),h(a)?(p(),v("div",Yo,[t("div",Zo,[C[0]||(C[0]=t("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 14.5c-.77.833.192 2.5 1.732 2.5z"})],-1)),E(" "+s(h(a)),1)])])):I("",!0),h(x)?(p(),Y(Jo,{key:1})):(p(),v("div",tr,[U(oe,{data:h(g)},null,8,["data"]),t("div",er,[U(Ee,{products:((A=h(g).products)==null?void 0:A.top_performers)||[]},null,8,["products"]),U(ks,{machines:((H=h(g).machines)==null?void 0:H.top_performers)||[]},null,8,["machines"])]),(G=h(g).locations)!=null&&G.performance&&h(g).locations.performance.length>0?(p(),Y(no,{key:0,locations:h(g).locations.performance},null,8,["locations"])):I("",!0),t("div",sr,[h(g).low_stock_items&&h(g).low_stock_items.length>0?(p(),Y(Vo,{key:0,data:h(g),"get-stock-level-class":h(i)},null,8,["data","get-stock-level-class"])):I("",!0),U(Oo,{data:h(g)},null,8,["data"])]),t("div",or,[t("div",rr,[C[3]||(C[3]=t("h3",{class:"text-lg font-semibold text-gray-900"},"Detailed Analytics",-1)),t("div",nr,[t("button",{onClick:y,disabled:h(F),class:"inline-flex items-center px-3 py-2 border border-gray-300 shadow-sm text-sm leading-4 font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"},C[1]||(C[1]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),E(" Refresh ")]),8,ar),t("button",{onClick:c,class:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500"},C[2]||(C[2]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),E(" Export Report ")]))])]),t("div",ir,[t("div",lr,[t("div",dr,s($(((W=h(g).summary)==null?void 0:W.total_demand_units)||0)),1),C[4]||(C[4]=t("div",{class:"text-sm text-gray-600"},"Total Units Sold",-1)),t("div",cr," Avg: "+s($(((J=h(g).summary)==null?void 0:J.avg_daily_demand)||0))+"/day ",1)]),t("div",ur,[t("div",mr," $"+s(m(((Q=h(g).summary)==null?void 0:Q.total_revenue)||0)),1),C[5]||(C[5]=t("div",{class:"text-sm text-gray-600"},"Total Revenue",-1)),t("div",xr,s(((X=h(g).summary)==null?void 0:X.total_restocks)||0)+" restocks ",1)]),t("div",gr,[t("div",fr," $"+s(m(((d=h(g).summary)==null?void 0:d.total_profit)||0)),1),C[6]||(C[6]=t("div",{class:"text-sm text-gray-600"},"Total Profit",-1)),t("div",pr,s((((b=h(g).summary)==null?void 0:b.overall_profit_margin)||0).toFixed(1))+"% margin ",1)]),t("div",yr,[t("div",vr,s(((L=h(g).summary)==null?void 0:L.unique_products)||0),1),C[7]||(C[7]=t("div",{class:"text-sm text-gray-600"},"Active Products",-1)),t("div",hr,s(((j=h(g).summary)==null?void 0:j.unique_machines)||0)+" machines ",1)])])])]))])])}}};export{$r as default};
