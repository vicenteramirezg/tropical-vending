import{r as i,j as $,o as q,c as n,a as e,g as A,e as c,w as p,v as x,F as b,d as h,t as a,h as G,i as O,f as r,n as J}from"./index-Do3wrZzx.js";import{a as w}from"./api-CEYTFEFu.js";const K={class:"bg-white p-5 shadow-lg rounded-xl mb-6"},Q={class:"flex flex-wrap items-center gap-4"},W=["value"],X={key:0,class:"flex justify-center py-20"},Y={key:1,class:"bg-red-50 border-l-4 border-red-400 p-4 mb-6 rounded-r-lg shadow-sm"},Z={class:"flex"},ee={class:"ml-3"},te={class:"text-sm text-red-700"},oe={key:2,class:"bg-white shadow-lg rounded-xl overflow-hidden"},se={key:3,class:"space-y-6"},ne={class:"px-6 py-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center"},re={class:"text-lg font-medium text-gray-900"},le={class:"text-sm text-gray-500"},ie=["onClick"],ae={role:"list",class:"divide-y divide-gray-200"},de={class:"flex items-center justify-between"},me={class:"flex items-center"},ue={class:"text-sm font-medium text-primary-600"},ce={key:0,class:"text-sm text-gray-500 mt-1"},pe={class:"flex space-x-2"},fe=["onClick"],ve=["onClick"],ge={key:4,class:"fixed inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},ye={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},xe={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},be={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},he={class:"sm:flex sm:items-start"},we={class:"mt-3 text-center sm:mt-0 sm:text-left w-full"},ke={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"},Me={class:"mt-4 space-y-4"},Ce=["value"],Se=["value"],_e={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},Ve={type:"submit",class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:ml-3 sm:w-auto sm:text-sm"},Ae={key:5,class:"fixed inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},je={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},De={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},Ne={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Le={class:"sm:flex sm:items-start"},Be={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},Fe={class:"mt-2"},Re={class:"text-sm text-gray-500"},Ee={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},Te={__name:"Machines",setup(Ie){const j=i([]),C=i([]),S=i(!0),f=i(null),D=i({}),N=i({}),m=i({location:"",machineType:""}),L=$(()=>{const o={};return j.value.forEach(t=>{o[t.location]||(o[t.location]=[]),o[t.location].push(t)}),o}),R=i(["3D14","AMS 39640","AMS GB624","AMS-LB9 Combo","AP Snack Shop 111","AP Snack Shop 133","AP Snack Shop 152-D","AP Snack Shop 6600","AP Snack Shop III D20C","AP Studio 3","Crane 147","Crane 148","Crane 157","Crane 158","Crane 168","Crane 172","Crane 180","Crane 181","Crane 452","Crane 784","Dixie Narco","Dixie Narco 276E","Dixie Narco 348C","Dixie Narco 368","Dixie Narco 368 12","Dixie Narco 368 R","Dixie Narco 36812","Dixie Narco 414 CC","Dixie Narco 501-C","Dixie Narco 501E","ISI 3177","Lektro Vending V599C Serie II","Royal Vendor 390-9","Royal Vendor 462-9","Royal Vendor 550-6","Royal Vendor 630-10","Royal Vendor 650-10","Royal Vendor 660","Royal Vendor 660-8","Royal Vendor 660-9","Royal Vendor 804-","Royal Vendor 804-13","Royal Vendor 804-9","Snack Mart 111 3000/Model: 301A","Snack Shop 111","Snack Shop 111 D206","Snack Shop 113","Snack Shop 6000","Snack Shop 6600","Snack Shop III 400 / Model:3014","Snack Shop LCM2","USA 3129","USI 3014A","USI 3166"]),u=i(!1),v=i(!1),g=i(!1),y=i(null),l=i({id:null,name:"",location:"",machine_type:"",model:""}),k=async()=>{S.value=!0;try{const o={location:m.value.location||void 0,machine_type:m.value.machineType||void 0},t=await w.getMachines(o);j.value=t.data}catch(o){console.error("Error fetching machines:",o),f.value="Failed to load machines. Please try again later."}finally{S.value=!1}},E=async()=>{try{const o=await w.getLocations();C.value=o.data,o.data.forEach(t=>{N.value[t.id]=t.name,D.value[t.id]=t})}catch(o){console.error("Error fetching locations:",o)}},_=()=>{k()},I=o=>{if(!o||!o.address)return;const M=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(o.address)}`;window.open(M,"_blank")},B=()=>{g.value=!1,l.value={id:null,name:"",location:"",machine_type:"",model:""},u.value=!0},U=o=>{g.value=!0,l.value={id:o.id,name:o.name,location:o.location,machine_type:o.machine_type,model:o.model},u.value=!0},z=async()=>{try{g.value?await w.updateMachine(l.value.id,l.value):await w.createMachine(l.value),u.value=!1,await k()}catch(o){console.error("Error saving machine:",o),f.value="Failed to save machine. Please try again."}},T=o=>{y.value=o,v.value=!0},H=async()=>{if(y.value)try{await w.deleteMachine(y.value.id),v.value=!1,await k()}catch(o){console.error("Error deleting machine:",o),f.value="Failed to delete machine. Please try again."}};return q(async()=>{await Promise.all([E(),k()])}),(o,t)=>{var M,F;return r(),n("div",null,[e("div",{class:"flex justify-between items-center mb-6"},[t[11]||(t[11]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Machines",-1)),e("button",{onClick:B,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-150"},t[10]||(t[10]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),c(" Add Machine ")]))]),e("div",K,[e("div",Q,[e("div",null,[t[13]||(t[13]=e("label",{for:"locationFilter",class:"block text-sm font-medium text-gray-700 mb-1"},"Location",-1)),p(e("select",{id:"locationFilter","onUpdate:modelValue":t[0]||(t[0]=s=>m.value.location=s),class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",onChange:_},[t[12]||(t[12]=e("option",{value:""},"All Locations",-1)),(r(!0),n(b,null,h(C.value,s=>(r(),n("option",{key:s.id,value:s.id},a(s.name),9,W))),128))],544),[[x,m.value.location]])]),e("div",null,[t[15]||(t[15]=e("label",{for:"typeFilter",class:"block text-sm font-medium text-gray-700 mb-1"},"Machine Type",-1)),p(e("select",{id:"typeFilter","onUpdate:modelValue":t[1]||(t[1]=s=>m.value.machineType=s),class:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm",onChange:_},t[14]||(t[14]=[e("option",{value:""},"All Types",-1),e("option",{value:"Snack"},"Snack",-1),e("option",{value:"Soda"},"Soda",-1),e("option",{value:"Combo"},"Combo",-1)]),544),[[x,m.value.machineType]])]),e("div",{class:"self-end ml-auto mt-4"},[e("button",{type:"button",onClick:_,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-150"},t[16]||(t[16]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1),c(" Apply Filters ")]))])])]),S.value?(r(),n("div",X,t[17]||(t[17]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"},null,-1)]))):f.value?(r(),n("div",Y,[e("div",Z,[t[18]||(t[18]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])],-1)),e("div",ee,[e("p",te,a(f.value),1)])])])):Object.keys(L.value).length===0?(r(),n("div",oe,[e("div",{class:"px-6 py-8 text-center"},[t[20]||(t[20]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-16 w-16 mx-auto text-gray-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})],-1)),t[21]||(t[21]=e("h3",{class:"text-lg leading-6 font-medium text-gray-900 mb-2"},"No machines found",-1)),t[22]||(t[22]=e("div",{class:"mt-2 max-w-xl text-sm text-gray-500 mx-auto mb-6"},[e("p",null,"Get started by adding your first machine.")],-1)),e("button",{onClick:B,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-150"},t[19]||(t[19]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),c(" Add Machine ")]))])])):(r(),n("div",se,[(r(!0),n(b,null,h(L.value,(s,V)=>(r(),n("div",{key:V,class:"bg-white shadow-lg rounded-xl overflow-hidden"},[e("div",ne,[e("div",null,[e("h2",re,a(N.value[V]),1),e("p",le,a(s.length)+" machines",1)]),e("button",{onClick:d=>I(D.value[V]),class:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-150"},t[23]||(t[23]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1),c(" View on Maps ")]),8,ie)]),e("ul",ae,[(r(!0),n(b,null,h(s,d=>(r(),n("li",{key:d.id,class:"px-6 py-5 hover:bg-gray-50 transition-colors duration-150"},[e("div",de,[e("div",null,[e("div",me,[e("p",ue,a(d.name),1),e("span",{class:J(["ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-blue-100 text-blue-800":d.machine_type==="Soda","bg-green-100 text-green-800":d.machine_type==="Snack","bg-purple-100 text-purple-800":d.machine_type==="Combo"}])},a(d.machine_type),3)]),d.model?(r(),n("p",ce,"Model: "+a(d.model),1)):A("",!0)]),e("div",pe,[e("button",{onClick:P=>U(d),class:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-150"},t[24]||(t[24]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1),c(" Edit ")]),8,fe),e("button",{onClick:P=>T(d),class:"inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-xs font-medium rounded-md text-gray-700 bg-white hover:bg-red-50 hover:text-red-700 hover:border-red-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors duration-150"},t[25]||(t[25]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),c(" Delete ")]),8,ve)])])]))),128))])]))),128))])),u.value?(r(),n("div",ge,[e("div",ye,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:t[2]||(t[2]=s=>u.value=!1)}),t[33]||(t[33]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",xe,[e("form",{onSubmit:G(z,["prevent"])},[e("div",be,[e("div",he,[e("div",we,[e("h3",ke,a(g.value?"Edit Machine":"Add New Machine"),1),e("div",Me,[e("div",null,[t[26]||(t[26]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Machine Name",-1)),p(e("input",{type:"text",name:"name",id:"name","onUpdate:modelValue":t[3]||(t[3]=s=>l.value.name=s),placeholder:"e.g. Building A Snack Machine",class:"mt-1 focus:ring-primary-500 focus:border-primary-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",required:""},null,512),[[O,l.value.name]])]),e("div",null,[t[28]||(t[28]=e("label",{for:"location",class:"block text-sm font-medium text-gray-700"},"Location",-1)),p(e("select",{id:"location",name:"location","onUpdate:modelValue":t[4]||(t[4]=s=>l.value.location=s),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md",required:""},[t[27]||(t[27]=e("option",{value:"",disabled:""},"Select a location",-1)),(r(!0),n(b,null,h(C.value,s=>(r(),n("option",{key:s.id,value:s.id},a(s.name),9,Ce))),128))],512),[[x,l.value.location]])]),e("div",null,[t[30]||(t[30]=e("label",{for:"machine_type",class:"block text-sm font-medium text-gray-700"},"Machine Type",-1)),p(e("select",{id:"machine_type",name:"machine_type","onUpdate:modelValue":t[5]||(t[5]=s=>l.value.machine_type=s),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md",required:""},t[29]||(t[29]=[e("option",{value:"",disabled:""},"Select a machine type",-1),e("option",{value:"Snack"},"Snack",-1),e("option",{value:"Soda"},"Soda",-1),e("option",{value:"Combo"},"Combo",-1)]),512),[[x,l.value.machine_type]])]),e("div",null,[t[32]||(t[32]=e("label",{for:"model",class:"block text-sm font-medium text-gray-700"},"Model (Optional)",-1)),p(e("select",{id:"model",name:"model","onUpdate:modelValue":t[6]||(t[6]=s=>l.value.model=s),class:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md"},[t[31]||(t[31]=e("option",{value:""},"Select a model (optional)",-1)),(r(!0),n(b,null,h(R.value,s=>(r(),n("option",{key:s,value:s},a(s),9,Se))),128))],512),[[x,l.value.model]])])])])])]),e("div",_e,[e("button",Ve,a(g.value?"Update":"Add"),1),e("button",{type:"button",onClick:t[7]||(t[7]=s=>u.value=!1),class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Cancel ")])],32)])])])):A("",!0),v.value?(r(),n("div",Ae,[e("div",je,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:t[8]||(t[8]=s=>v.value=!1)}),t[36]||(t[36]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",De,[e("div",Ne,[e("div",Le,[t[35]||(t[35]=e("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10"},[e("svg",{class:"h-6 w-6 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),e("div",Be,[t[34]||(t[34]=e("h3",{class:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"}," Delete Machine ",-1)),e("div",Fe,[e("p",Re," Are you sure you want to delete the "+a((M=y.value)==null?void 0:M.name)+" ("+a((F=y.value)==null?void 0:F.machine_type)+")? This action cannot be undone. ",1)])])])]),e("div",Ee,[e("button",{type:"button",onClick:H,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm"}," Delete "),e("button",{type:"button",onClick:t[9]||(t[9]=s=>v.value=!1),class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Cancel ")])])])])):A("",!0)])}}};export{Te as default};
