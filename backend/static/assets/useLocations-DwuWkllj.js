import{a as n}from"./api-BZqk93rT.js";import{r as o,q as F,g as R}from"./index-Dr1fHcBK.js";function P(){const a=o([]),r=o([]),d=o([]),p=o(!0),c=o(null),s=o(""),f=o([]),g={Vending:"bg-blue-100 text-blue-800",Coffee:"bg-amber-100 text-amber-800",Snack:"bg-green-100 text-green-800",Drink:"bg-purple-100 text-purple-800"},v=F(()=>{const e={};return a.value.forEach(t=>{e[t.id]={}}),d.value.forEach(t=>{t.location&&(e[t.location]||(e[t.location]={}),e[t.location][t.machine_type]||(e[t.location][t.machine_type]=0),e[t.location][t.machine_type]++)}),e}),l=async()=>{p.value=!0;try{const e=await n.getLocations();r.value=e.data,a.value=e.data,await Promise.all([y(),h()])}catch(e){console.error("Error fetching locations:",e),c.value="Failed to load locations. Please try again later."}finally{p.value=!1}},y=async()=>{try{const e=await n.getMachines();d.value=e.data}catch(e){console.error("Error fetching machines:",e)}},h=async()=>{try{const e=await n.getRoutes();f.value=e.data.routes}catch(e){console.error("Error fetching routes:",e)}},w=async e=>{try{await n.createLocation(e),await l(),i()}catch(t){throw console.error("Error creating location:",t),c.value="Failed to create location. Please try again.",t}},m=async(e,t)=>{try{await n.updateLocation(e,t),await l(),i()}catch(u){throw console.error("Error updating location:",u),c.value="Failed to update location. Please try again.",u}},L=async e=>{try{await n.deleteLocation(e),await l(),i()}catch(t){throw console.error("Error deleting location:",t),c.value="Failed to delete location. Please try again.",t}},b=()=>{s.value?s.value==="unassigned"?a.value=r.value.filter(e=>!e.route):a.value=r.value.filter(e=>e.route===s.value):a.value=r.value},i=()=>{s.value="",a.value=r.value},E=e=>{if(!e||!e.address)return;const u=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e.address)}`;window.open(u,"_blank")};return R(l),{locations:a,allLocations:r,machines:d,loading:p,error:c,selectedRoute:s,availableRoutes:f,machineTypeColors:g,locationMachines:v,fetchLocations:l,createLocation:w,updateLocation:m,deleteLocation:L,applyRouteFilter:b,clearRouteFilter:i,openMapForLocation:E}}export{P as u};
